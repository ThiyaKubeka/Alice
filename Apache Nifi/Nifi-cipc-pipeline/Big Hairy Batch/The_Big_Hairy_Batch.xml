<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<template encoding-version="1.2">
    <description></description>
    <groupId>d7ab2f6e-0165-1000-1ed4-92c57c9de7dc</groupId>
    <name>The Big Hairy Batch</name>
    <snippet>
        <processGroups>
            <id>4f2953fe-9999-3962-0000-000000000000</id>
            <parentGroupId>a9c0ecbd-5ff1-3128-0000-000000000000</parentGroupId>
            <position>
                <x>0.0</x>
                <y>0.0</y>
            </position>
            <comments></comments>
            <contents>
                <connections>
                    <id>007f6995-365d-39b5-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>eec8066e-3af5-31d3-88f4-0bd4f0c95c7e</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>7160e47c-3c05-339b-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>e3117c86-3eb3-3cb6-a57a-b8a0e05232f0</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name>matched</name>
                    <selectedRelationships>matched</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>ee0818b3-b03e-3f01-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>65d68dbc-899f-339b-bf55-ab8cbaf78d0c</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>140102b7-5bf5-3f7f-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>79debeea-fac5-3dc9-bb2d-1ba72b173b21</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>498a584a-b8f7-3810-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>62f19e4a-9abe-3c93-9055-66d6ae302e65</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <prioritizers>org.apache.nifi.prioritizer.FirstInFirstOutPrioritizer</prioritizers>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>2e05ab39-1cac-355e-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>c11fba1a-a8b6-33d0-888c-ece60f695697</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>1408f3b3-b521-34ab-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>d2782a4e-c5d8-3a64-9721-6f4776e443b2</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>b1a39434-312a-3ccf-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>b99d0193-389a-3bf6-bdc2-4448c72b0dd3</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <prioritizers>org.apache.nifi.prioritizer.FirstInFirstOutPrioritizer</prioritizers>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>5d9f7b8e-8ee5-3f79-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>f906871b-27d4-36b4-886c-8325d07168ed</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>1ad29944-a48e-3646-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>bc902a6b-28d4-36d8-ad09-0e0d9247d7eb</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>2e05ab39-1cac-355e-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>c11fba1a-a8b6-33d0-888c-ece60f695697</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <prioritizers>org.apache.nifi.prioritizer.FirstInFirstOutPrioritizer</prioritizers>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>2a609d17-18fc-3210-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>86ef452b-68e0-3a6a-9936-75f51f16d006</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>3454bbfe-0b7c-3a48-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>11c1ed29-cd5d-32bc-ba0c-7209d87e3dd7</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>93dcd10c-a8c7-3a6b-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>a8a350a0-f91e-3d1c-8b4f-b6e986825487</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <selectedRelationships>failure</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>7eab20ce-b8f4-3a49-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>66b71b2e-c3be-3acf-8ae1-185274618d42</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>6d459ebd-f449-341b-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>bf97b39b-6688-3e73-81b9-b43d76e56f6a</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>b4923e9e-3cf5-3664-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>c5123755-f55a-3c61-8724-2ac92a404723</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <selectedRelationships>matched</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>546fd60d-6557-3a2b-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>55d095c5-04c7-395e-9a96-396ea24a5a24</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>6df395c9-b3fe-3656-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>39771d9e-07da-301d-a399-f43982a8f2f9</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>2a609d17-18fc-3210-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>86ef452b-68e0-3a6a-9936-75f51f16d006</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <prioritizers>org.apache.nifi.prioritizer.FirstInFirstOutPrioritizer</prioritizers>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>c17fe8c4-18a9-379b-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>000e2d83-efbe-349d-862f-6a55886f39aa</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>753685e2-dfb5-3f7f-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>650c7206-bb0f-3585-81fd-637062f412d5</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>5337b835-7033-3254-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>571c9ab8-678e-3270-8b76-841f4ad4c660</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>c17fe8c4-18a9-379b-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>000e2d83-efbe-349d-862f-6a55886f39aa</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>83faf203-0180-38ad-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>4108b42d-4074-3751-bd08-9d9165642fd6</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>ee0818b3-b03e-3f01-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>65d68dbc-899f-339b-bf55-ab8cbaf78d0c</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>5337b835-7033-3254-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>571c9ab8-678e-3270-8b76-841f4ad4c660</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>af22a6d2-43a0-3647-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>a62490f9-e075-3368-8192-fe20884b50f5</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>5d82c796-0321-3bdb-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>5ef2ac3f-6f15-3127-ae67-20138737da41</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <prioritizers>org.apache.nifi.prioritizer.FirstInFirstOutPrioritizer</prioritizers>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>236b1af2-94be-3229-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>9a048a80-ac29-3745-8709-0673eb445a89</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>b4897edc-0ebb-3416-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>3cabea68-56fd-31e0-b437-3fda762e4620</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>5d9f7b8e-8ee5-3f79-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>f906871b-27d4-36b4-886c-8325d07168ed</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <selectedRelationships>no</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>7458c830-857d-3299-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>afbb2094-add9-3e24-873b-820ec3e5ebf8</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>c293187c-c1b6-32d7-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>9dce3a7a-78cb-37c9-9887-fac0f6cc5a75</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>7eab20ce-b8f4-3a49-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>66b71b2e-c3be-3acf-8ae1-185274618d42</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>33c40db1-b0fa-3fa0-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>4311cceb-a7a0-3bd1-aa2e-ec1091102763</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>cd227d03-7fac-37e2-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>db0f8edd-5398-3066-96de-9aba614abcd7</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>546fd60d-6557-3a2b-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>55d095c5-04c7-395e-9a96-396ea24a5a24</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <selectedRelationships>attachments</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>7160e47c-3c05-339b-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>e3117c86-3eb3-3cb6-a57a-b8a0e05232f0</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>ef08aa57-da13-3c4b-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>c02cd25e-6f1d-32b3-a4e8-e19cfcb651e6</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>7458c830-857d-3299-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>afbb2094-add9-3e24-873b-820ec3e5ebf8</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>498a584a-b8f7-3810-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>62f19e4a-9abe-3c93-9055-66d6ae302e65</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>eff31270-4252-3890-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>2d57c2b7-c0e4-32a5-98a7-7bbea57edb8a</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>33c40db1-b0fa-3fa0-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>4311cceb-a7a0-3bd1-aa2e-ec1091102763</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <prioritizers>org.apache.nifi.prioritizer.FirstInFirstOutPrioritizer</prioritizers>
                    <selectedRelationships>success</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>b4923e9e-3cf5-3664-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>c5123755-f55a-3c61-8724-2ac92a404723</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <connections>
                    <id>fbcb564d-cfc7-34f1-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <versionedComponentId>e5e9529b-0be5-3556-b838-a553bde9217a</versionedComponentId>
                    <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                    <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                    <destination>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>236b1af2-94be-3229-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>9a048a80-ac29-3745-8709-0673eb445a89</versionedComponentId>
                    </destination>
                    <flowFileExpiration>0 sec</flowFileExpiration>
                    <labelIndex>1</labelIndex>
                    <name></name>
                    <selectedRelationships>yes</selectedRelationships>
                    <source>
                        <groupId>4f2953fe-9999-3962-0000-000000000000</groupId>
                        <id>7458c830-857d-3299-0000-000000000000</id>
                        <type>PROCESSOR</type>
                        <versionedComponentId>afbb2094-add9-3e24-873b-820ec3e5ebf8</versionedComponentId>
                    </source>
                    <zIndex>0</zIndex>
                </connections>
                <processGroups>
                    <id>bf0dc036-8ecf-37f5-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-806.326919938173</x>
                        <y>101.33468564104055</y>
                    </position>
                    <versionedComponentId>dad73725-0a37-3d34-8100-9eaaf48f0234</versionedComponentId>
                    <comments></comments>
                    <contents>
                        <connections>
                            <id>227ff110-5766-3b38-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>ff8f2a58-29d9-38c7-975e-42a1d5164844</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>7de32b1f-aff8-3167-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>61b6e28e-4b05-32d6-a52f-0b213bfe9ccc</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>failure</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>51e1a15b-9b84-37b4-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>c1250b4b-9518-33bf-a2e0-1f2a71116515</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>33b45ed3-e960-36ae-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>ea6f1589-3ae4-37e0-8718-947a31df8e3b</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>7fcfd624-0a55-3380-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>70622acb-8b1f-3f57-b375-f51fe23223c2</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>2dba7078-eaba-3032-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>5dfa1651-e4fa-3385-befb-40f0d4a7e975</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>47da213c-8146-33fa-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>9bdeedb4-265e-3817-8171-a79019eb6b7f</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>2dba7078-eaba-3032-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>5dfa1651-e4fa-3385-befb-40f0d4a7e975</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>51e1a15b-9b84-37b4-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>c1250b4b-9518-33bf-a2e0-1f2a71116515</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>47eb19d0-aedb-3d0d-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>6af5d860-0331-30d1-956a-401aeb471bea</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>51e1a15b-9b84-37b4-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>c1250b4b-9518-33bf-a2e0-1f2a71116515</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>6da6e4e8-7897-3127-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>6b63f25f-c51d-36e9-9c5f-8b719d4f15be</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>64cf9ced-6ed5-3b86-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>e48d31f4-a518-3cb3-0000-000000000000</id>
<type>PROCESSOR</type>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>020dd08a-fbd5-3315-0000-000000000000</id>
<type>PROCESSOR</type>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>6ff66544-506d-3de3-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>a818bd3f-50f8-341d-9622-cc3e260703fa</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>ef5cf176-56a4-3721-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>c694c5ac-0d85-3c17-8daa-f62b9d3b5301</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>5b4312f0-f4e3-3861-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>c1aeb13f-4945-35b6-ac1d-2b63ccb0987e</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>6ffd3125-824d-3d5c-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>58cb2fa4-34a5-3160-b738-bbfbbd3e2055</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>2ad5d873-6501-3ccf-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>20a03f33-1935-31d8-bcb7-8a85786b5875</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>matched</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>7de32b1f-aff8-3167-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>61b6e28e-4b05-32d6-a52f-0b213bfe9ccc</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>ac61d2c4-8772-3ac8-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>d1d4fa39-4dac-3a34-9b83-6e1e3d788e51</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <bends>
<x>-303.8999179850482</x>
<y>492.21195920061086</y>
                            </bends>
                            <bends>
<x>-303.8999179850482</x>
<y>542.2119592006109</y>
                            </bends>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>51e1a15b-9b84-37b4-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>c1250b4b-9518-33bf-a2e0-1f2a71116515</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>0</labelIndex>
                            <name></name>
                            <selectedRelationships>wait</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>51e1a15b-9b84-37b4-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>c1250b4b-9518-33bf-a2e0-1f2a71116515</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>bf75b44f-3fa0-372a-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>7d005e60-5696-3632-80c6-c66cc3288e46</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>6da6e4e8-7897-3127-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>6b63f25f-c51d-36e9-9c5f-8b719d4f15be</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>ef5cf176-56a4-3721-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>c694c5ac-0d85-3c17-8daa-f62b9d3b5301</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>ef87efe2-e08d-323e-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>7908b283-c8d3-3c9e-b157-b265a72ba3cd</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>6c9942cc-e95e-3033-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>2baec024-d2a5-3c8f-aca9-9533e5b81032</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>bf0dc036-8ecf-37f5-0000-000000000000</groupId>
<id>7fcfd624-0a55-3380-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>70622acb-8b1f-3f57-b375-f51fe23223c2</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <controllerServices>
                            <id>4fc88d0b-796e-3083-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <versionedComponentId>ba3dc45c-b175-3618-a8d0-8bf58cf94bcc</versionedComponentId>
                            <bundle>
<artifact>nifi-livy-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <comments></comments>
                            <descriptors>
<entry>
    <key>livy-cs-livy-host</key>
    <value>
        <name>livy-cs-livy-host</name>
    </value>
</entry>
<entry>
    <key>livy-cs-livy-port</key>
    <value>
        <name>livy-cs-livy-port</name>
    </value>
</entry>
<entry>
    <key>livy-cs-session-pool-size</key>
    <value>
        <name>livy-cs-session-pool-size</name>
    </value>
</entry>
<entry>
    <key>livy-cs-session-kind</key>
    <value>
        <name>livy-cs-session-kind</name>
    </value>
</entry>
<entry>
    <key>livy-cs-session-manager-status-interval</key>
    <value>
        <name>livy-cs-session-manager-status-interval</name>
    </value>
</entry>
<entry>
    <key>SSL Context Service</key>
    <value>
        <identifiesControllerService>org.apache.nifi.ssl.SSLContextService</identifiesControllerService>
        <name>SSL Context Service</name>
    </value>
</entry>
<entry>
    <key>Connection Timeout</key>
    <value>
        <name>Connection Timeout</name>
    </value>
</entry>
<entry>
    <key>livy-cs-session-jars</key>
    <value>
        <name>livy-cs-session-jars</name>
    </value>
</entry>
<entry>
    <key>livy-cs-session-files</key>
    <value>
        <name>livy-cs-session-files</name>
    </value>
</entry>
<entry>
    <key>kerberos-credentials-service</key>
    <value>
        <identifiesControllerService>org.apache.nifi.kerberos.KerberosCredentialsService</identifiesControllerService>
        <name>kerberos-credentials-service</name>
    </value>
</entry>
                            </descriptors>
                            <name>LivySessionController</name>
                            <persistsState>false</persistsState>
                            <properties>
<entry>
    <key>livy-cs-livy-host</key>
    <value>Livy</value>
</entry>
<entry>
    <key>livy-cs-livy-port</key>
    <value>8998</value>
</entry>
<entry>
    <key>livy-cs-session-pool-size</key>
    <value>2</value>
</entry>
<entry>
    <key>livy-cs-session-kind</key>
    <value>spark</value>
</entry>
<entry>
    <key>livy-cs-session-manager-status-interval</key>
    <value>2 sec</value>
</entry>
<entry>
    <key>SSL Context Service</key>
</entry>
<entry>
    <key>Connection Timeout</key>
    <value>5 secs</value>
</entry>
<entry>
    <key>livy-cs-session-jars</key>
</entry>
<entry>
    <key>livy-cs-session-files</key>
</entry>
<entry>
    <key>kerberos-credentials-service</key>
</entry>
                            </properties>
                            <state>ENABLED</state>
                            <type>org.apache.nifi.controller.livy.LivySessionController</type>
                        </controllerServices>
                        <processors>
                            <id>020dd08a-fbd5-3315-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-233.96242702936115</x>
<y>-34.103776807957956</y>
                            </position>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Input Directory</key>
        <value>
            <name>Input Directory</name>
        </value>
    </entry>
    <entry>
        <key>Recurse Subdirectories</key>
        <value>
            <name>Recurse Subdirectories</name>
        </value>
    </entry>
    <entry>
        <key>Input Directory Location</key>
        <value>
            <name>Input Directory Location</name>
        </value>
    </entry>
    <entry>
        <key>File Filter</key>
        <value>
            <name>File Filter</name>
        </value>
    </entry>
    <entry>
        <key>Path Filter</key>
        <value>
            <name>Path Filter</name>
        </value>
    </entry>
    <entry>
        <key>Include File Attributes</key>
        <value>
            <name>Include File Attributes</name>
        </value>
    </entry>
    <entry>
        <key>Minimum File Age</key>
        <value>
            <name>Minimum File Age</name>
        </value>
    </entry>
    <entry>
        <key>Maximum File Age</key>
        <value>
            <name>Maximum File Age</name>
        </value>
    </entry>
    <entry>
        <key>Minimum File Size</key>
        <value>
            <name>Minimum File Size</name>
        </value>
    </entry>
    <entry>
        <key>Maximum File Size</key>
        <value>
            <name>Maximum File Size</name>
        </value>
    </entry>
    <entry>
        <key>Ignore Hidden Files</key>
        <value>
            <name>Ignore Hidden Files</name>
        </value>
    </entry>
    <entry>
        <key>target-system-timestamp-precision</key>
        <value>
            <name>target-system-timestamp-precision</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Input Directory</key>
        <value>/tmp/data/input/</value>
    </entry>
    <entry>
        <key>Recurse Subdirectories</key>
        <value>true</value>
    </entry>
    <entry>
        <key>Input Directory Location</key>
        <value>Local</value>
    </entry>
    <entry>
        <key>File Filter</key>
        <value>[^\.].*</value>
    </entry>
    <entry>
        <key>Path Filter</key>
    </entry>
    <entry>
        <key>Include File Attributes</key>
        <value>true</value>
    </entry>
    <entry>
        <key>Minimum File Age</key>
        <value>0 sec</value>
    </entry>
    <entry>
        <key>Maximum File Age</key>
    </entry>
    <entry>
        <key>Minimum File Size</key>
        <value>0 B</value>
    </entry>
    <entry>
        <key>Maximum File Size</key>
    </entry>
    <entry>
        <key>Ignore Hidden Files</key>
        <value>true</value>
    </entry>
    <entry>
        <key>target-system-timestamp-precision</key>
        <value>auto-detect</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>ListFile</name>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.ListFile</type>
                        </processors>
                        <processors>
                            <id>2ad5d873-6501-3ccf-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-767.4007210797272</x>
<y>1005.7299778922936</y>
                            </position>
                            <versionedComponentId>20a03f33-1935-31d8-bcb7-8a85786b5875</versionedComponentId>
                            <bundle>
<artifact>nifi-elasticsearch-5-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>el5-cluster-name</key>
        <value>
            <name>el5-cluster-name</name>
        </value>
    </entry>
    <entry>
        <key>el5-hosts</key>
        <value>
            <name>el5-hosts</name>
        </value>
    </entry>
    <entry>
        <key>el5-ssl-context-service</key>
        <value>
            <identifiesControllerService>org.apache.nifi.ssl.SSLContextService</identifiesControllerService>
            <name>el5-ssl-context-service</name>
        </value>
    </entry>
    <entry>
        <key>el5-xpack-location</key>
        <value>
            <name>el5-xpack-location</name>
        </value>
    </entry>
    <entry>
        <key>el5-username</key>
        <value>
            <name>el5-username</name>
        </value>
    </entry>
    <entry>
        <key>el5-password</key>
        <value>
            <name>el5-password</name>
        </value>
    </entry>
    <entry>
        <key>el5-ping-timeout</key>
        <value>
            <name>el5-ping-timeout</name>
        </value>
    </entry>
    <entry>
        <key>el5-sampler-interval</key>
        <value>
            <name>el5-sampler-interval</name>
        </value>
    </entry>
    <entry>
        <key>el5-put-id-attribute</key>
        <value>
            <name>el5-put-id-attribute</name>
        </value>
    </entry>
    <entry>
        <key>el5-put-index</key>
        <value>
            <name>el5-put-index</name>
        </value>
    </entry>
    <entry>
        <key>el5-put-type</key>
        <value>
            <name>el5-put-type</name>
        </value>
    </entry>
    <entry>
        <key>el5-charset</key>
        <value>
            <name>el5-charset</name>
        </value>
    </entry>
    <entry>
        <key>el5-put-batch-size</key>
        <value>
            <name>el5-put-batch-size</name>
        </value>
    </entry>
    <entry>
        <key>el5-put-index-op</key>
        <value>
            <name>el5-put-index-op</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>el5-cluster-name</key>
        <value>elasticsearch</value>
    </entry>
    <entry>
        <key>el5-hosts</key>
        <value>elasticsearch-master:9300</value>
    </entry>
    <entry>
        <key>el5-ssl-context-service</key>
    </entry>
    <entry>
        <key>el5-xpack-location</key>
    </entry>
    <entry>
        <key>el5-username</key>
        <value>elastic</value>
    </entry>
    <entry>
        <key>el5-password</key>
    </entry>
    <entry>
        <key>el5-ping-timeout</key>
        <value>5s</value>
    </entry>
    <entry>
        <key>el5-sampler-interval</key>
        <value>5s</value>
    </entry>
    <entry>
        <key>el5-put-id-attribute</key>
        <value>uuid</value>
    </entry>
    <entry>
        <key>el5-put-index</key>
        <value>evalue</value>
    </entry>
    <entry>
        <key>el5-put-type</key>
        <value>default</value>
    </entry>
    <entry>
        <key>el5-charset</key>
        <value>UTF-8</value>
    </entry>
    <entry>
        <key>el5-put-batch-size</key>
        <value>100</value>
    </entry>
    <entry>
        <key>el5-put-index-op</key>
        <value>index</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>PutElasticsearch5</name>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>retry</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.elasticsearch.PutElasticsearch5</type>
                        </processors>
                        <processors>
                            <id>2dba7078-eaba-3032-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-1343.600572153492</x>
<y>557.4207390151519</y>
                            </position>
                            <versionedComponentId>5dfa1651-e4fa-3385-befb-40f0d4a7e975</versionedComponentId>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>File to Fetch</key>
        <value>
            <name>File to Fetch</name>
        </value>
    </entry>
    <entry>
        <key>Completion Strategy</key>
        <value>
            <name>Completion Strategy</name>
        </value>
    </entry>
    <entry>
        <key>Move Destination Directory</key>
        <value>
            <name>Move Destination Directory</name>
        </value>
    </entry>
    <entry>
        <key>Move Conflict Strategy</key>
        <value>
            <name>Move Conflict Strategy</name>
        </value>
    </entry>
    <entry>
        <key>Log level when file not found</key>
        <value>
            <name>Log level when file not found</name>
        </value>
    </entry>
    <entry>
        <key>Log level when permission denied</key>
        <value>
            <name>Log level when permission denied</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>File to Fetch</key>
        <value>${absolute.path}/${filename}</value>
    </entry>
    <entry>
        <key>Completion Strategy</key>
        <value>Delete File</value>
    </entry>
    <entry>
        <key>Move Destination Directory</key>
    </entry>
    <entry>
        <key>Move Conflict Strategy</key>
        <value>Rename</value>
    </entry>
    <entry>
        <key>Log level when file not found</key>
        <value>ERROR</value>
    </entry>
    <entry>
        <key>Log level when permission denied</key>
        <value>ERROR</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>FetchOriginalFile</name>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>not.found</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>permission.denied</name>
                            </relationships>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.FetchFile</type>
                        </processors>
                        <processors>
                            <id>51e1a15b-9b84-37b4-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-758.899917985048</x>
<y>452.21195920061086</y>
                            </position>
                            <versionedComponentId>c1250b4b-9518-33bf-a2e0-1f2a71116515</versionedComponentId>
                            <bundle>
<artifact>nifi-livy-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>exec-spark-iactive-livy-controller-service</key>
        <value>
            <identifiesControllerService>org.apache.nifi.controller.api.livy.LivySessionService</identifiesControllerService>
            <name>exec-spark-iactive-livy-controller-service</name>
        </value>
    </entry>
    <entry>
        <key>exec-spark-iactive-code</key>
        <value>
            <name>exec-spark-iactive-code</name>
        </value>
    </entry>
    <entry>
        <key>exec-spark-iactive-charset</key>
        <value>
            <name>exec-spark-iactive-charset</name>
        </value>
    </entry>
    <entry>
        <key>exec-spark-iactive-status-check-interval</key>
        <value>
            <name>exec-spark-iactive-status-check-interval</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>exec-spark-iactive-livy-controller-service</key>
        <value>4fc88d0b-796e-3083-0000-000000000000</value>
    </entry>
    <entry>
        <key>exec-spark-iactive-code</key>
        <value>//imports
import org.apache.spark.sql.functions._
import org.apache.hadoop.fs.permission.FsPermission
import org.apache.hadoop.fs.FileSystem

import java.net.URI
import java.nio.file.{Files, Paths, StandardCopyOption}
import java.time.{LocalDateTime}
import java.time.format.DateTimeFormatter

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.OutputStream;

import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;
import org.apache.poi.poifs.crypt.EncryptionInfo
import org.apache.poi.poifs.crypt.EncryptionMode
import org.apache.poi.poifs.crypt.Encryptor

import org.apache.spark.sql.SQLContext
import org.apache.spark.sql.SQLContext._

import org.elasticsearch.spark.sql._
//cleaning functions
/**
 * Returns the difference between 2 dataframes with identical schemas
 **/
def diff (left: org.apache.spark.sql.DataFrame, right: org.apache.spark.sql.DataFrame) : ( org.apache.spark.sql.DataFrame) = {
    left.unionAll(right).except(left.intersect(right))
}

/**
 * Filters for empty values
 *
 * Returns 2 dataframes.
 * First dataframe are all the records that contain non-empty fields
 * Second dataframe are all the records that contain empty field
 **/
def filterEmpty (df: org.apache.spark.sql.DataFrame) : (org.apache.spark.sql.DataFrame, org.apache.spark.sql.DataFrame) = {
    val good = df.na.drop("any")
    val bad = diff(good,df)
    (good, bad)
}

/**
 * Filters for invalid characters in the ID field
 *
 * Returns 2 dataframes.
 * First dataframe are all the records that returned positive for the filter
 * Second dataframe are all the records that returned negative for the filter
 **/
def filterInvalid (df: org.apache.spark.sql.DataFrame) : (org.apache.spark.sql.DataFrame, org.apache.spark.sql.DataFrame) = {
    val good = df.filter(!$"Id".rlike("[a-zA-Z]"))
    val bad = diff(good,df)
    (good,bad)
}

/**
 * Filters for duplicate records
 *
 * Returns 2 dataframes.
 * First dataframe are all the unique records
 * Second dataframe are all the extra duplicate records
 **/
def filterDups (df: org.apache.spark.sql.DataFrame) : (org.apache.spark.sql.DataFrame, org.apache.spark.sql.DataFrame) = {
    val _df = df.withColumn("rowId", monotonically_increasing_id())
    val good = _df.dropDuplicates("Id")
    val bad = diff(good,_df).drop("rowId")
    (good.drop("rowId"),bad)
}

//utility functions
/**
 * Move a file from source to destination
 * This method preserves file permissions
 **/

def moveFile(src:String, dst: String) : Unit = {

    val path = Files.move(
        Paths.get(src),
        Paths.get(dst),
        StandardCopyOption.REPLACE_EXISTING
    )

    if (path != null) {
        println(s"moved the file $src successfully")
    } else {
        println(s"could NOT move the file $dst")
    }
}

/**
 * Change a file's permissions
 **/
def chmod(file: String, umode: String) : Unit = {
    val uri = new URI(file)
    val fileSystem = FileSystem.get(uri,new org.apache.hadoop.conf.Configuration())
    fileSystem.setPermission(new org.apache.hadoop.fs.Path(uri), new FsPermission(umode))
}

def now() : String = {
    val dtf: DateTimeFormatter = DateTimeFormatter.ofPattern("yyyy/MM/dd HH:mm:ss")
	val currentTime: LocalDateTime = LocalDateTime.now()
	dtf.format(currentTime).toString()
}

case class Stat(stat: String, number: Long)

//set up elasticsearch settings
val es_settings = Map("es.nodes" -&gt; "elasticsearch-master",
                     "es.net.http.auth.user" -&gt; "elastic",
                     "es.net.http.auth.pass" -&gt; "passwd",
                     "es.mapping.id" -&gt; "BatchRef")

//values from nifi
val nifi_filename = "${filename}"
val nifi_dir = "${absolute.path}"
val nifi_pswd = "${password}"

//run values for reporting
val applicationId = "AppId: "+ sc.applicationId
val sessionId = "SessionId: "+ sc.appName.split('-').last
val executionId = "ExecutionId: "+ sc.getLocalProperty("spark.job.description").split(" ").last
val date = "Date: "+ now()
val client = "Client: " + nifi_filename.split("_").head
val details_df = Seq(applicationId,sessionId,executionId,date,client).toDF("Details")


//run configuration and variables
val source_dir = nifi_dir
val source_filename = nifi_filename

val temp_workdir = "/tmp/data/processing/"
val output_dir = "/tmp/data/output/"
val processed_dir = "/tmp/data/processed/"

val output_filename_base = source_filename.split("\\.xlsx").head
val output_filename = nifi_pswd + "__" + output_filename_base + "_output" + ".xlsx"

val input_file = source_dir+source_filename
val temp_file = temp_workdir+output_filename
val output_file = output_dir+output_filename


// create Elasticsearch Reader
val es_reader = spark.read.format("es").
    option("es.nodes","elasticsearch-master").
    option("es.net.http.auth.user","elastic").
    option("es.net.http.auth.pass","passwd")

//read Data from Elasticsearch
val people = es_reader.load("people")


//read source data file
val input_raw = spark.read.format("com.crealytics.spark.excel").
    option("useHeader", "true"). // Required
    option("treatEmptyValuesAsNulls", "true"). // Optional, default: true
    option("inferSchema", "false"). // Optional, default: false
    option("timestampFormat", "MM-dd-yyyy HH:mm:ss"). // Optional, default: yyyy-mm-dd hh:mm:ss[.fffffffff]
    option("maxRowsInMemory", 20). // Optional, default None. If set, uses a streaming reader which can help with big files
    option("excerptSize", 10). // Optional, default: 10. If set and if schema inferred, number of rows to infer schema from
    load(input_file)

//drop empty Id's
val (non_empty , empty) = filterEmpty(input_raw)

//clean invalid chars
val (valid , invalid) = filterInvalid(non_empty)

//deduplicate
val (uniques , duplicates) = filterDups(valid)

//get info from db
val joined = uniques.alias("A").
                    join(people.alias("B"),expr("A.Id == B.id"),"left").
                    select($"A.*",
                           $"B.id".as("db_id"),
                           $"B.first_name",
                           $"B.last_name",
                           $"B.gender",
                           $"B.email",
                           $"B.ip_address",
                           $"B.deceased")

val exists_in_db = joined.filter(not($"db_id".isNull)).drop($"db_id")
val not_exists_in_db = joined.filter($"db_id".isNull).drop($"db_id")

//write results
exists_in_db.write.
  format("com.crealytics.spark.excel").
  option("dataAddress", "'Contact_Output'!A1").
  option("useHeader", "true").
  option("dateFormat", "yy-mmm-d"). // Optional, default: yy-m-d h:mm
  option("timestampFormat", "mm-dd-yyyy hh:mm:ss"). // Optional, default: yyyy-mm-dd hh:mm:ss.000
  mode("overwrite"). // Optional, default: overwrite.
  save(temp_file)

not_exists_in_db.write.
  format("com.crealytics.spark.excel").
  option("dataAddress", "'NotFound'!A1").
  option("useHeader", "true").
  option("dateFormat", "yy-mmm-d"). // Optional, default: yy-m-d h:mm
  option("timestampFormat", "mm-dd-yyyy hh:mm:ss"). // Optional, default: yyyy-mm-dd hh:mm:ss.000
  mode("append"). // Optional, default: overwrite.
  save(temp_file)


//Batch statistics
val orig_count = input_raw.count
val null_count = empty.count
val invalid_count = invalid.count
val duplicates_count = duplicates.count
val valids_count = uniques.count

//Matching statistics
val exists_count = exists_in_db.count
val not_exists_count = not_exists_in_db.count

//Content statistics
//alive
val alive_consumers = exists_in_db.filter($"deceased" === true).count
//dead
val dead_consumers = exists_in_db.filter($"deceased" === false).count
//male
val male_consumers = exists_in_db.filter($"gender" === "Male").count
//female
val female_consumers = exists_in_db.filter($"gender" === "Female").count
//email
val has_email = exists_in_db.filter(not($"email".isNull)).count
//ip_address
val has_ip_address = exists_in_db.filter(not($"ip_address".isNull)).count


//Create Stats Section
details_df.write.
  format("com.crealytics.spark.excel").
  option("dataAddress", "'Stats'!A2").
  option("useHeader", "false").
  option("dateFormat", "yy-mmm-d"). // Optional, default: yy-m-d h:mm
  option("timestampFormat", "mm-dd-yyyy hh:mm:ss"). // Optional, default: yyyy-mm-dd hh:mm:ss.000
  mode("append"). // Optional, default: overwrite.
  save(temp_file)

//Batch statistics
val batchStats = Seq(Stat("Number of records supplied", orig_count),
                     Stat("Duplicates", duplicates_count),
                     Stat("Valid Idnumbers", valids_count),
                     Stat("Blank records", null_count),
                     Stat("Invalid records", invalid_count)
                     ).toDF("Batch Statistics","Number").withColumn("%",concat(lit(($"Number"/orig_count*100)),lit("%")))

batchStats.write.
  format("com.crealytics.spark.excel").
  option("dataAddress", "'Stats'!A10").
  option("useHeader", "true").
  option("dateFormat", "yy-mmm-d"). // Optional, default: yy-m-d h:mm
  option("timestampFormat", "mm-dd-yyyy hh:mm:ss"). // Optional, default: yyyy-mm-dd hh:mm:ss.000
  mode("append"). // Optional, default: overwrite.
  save(temp_file)

//Matching statistics
val matchingStats = Seq(Stat("Consumers matched", exists_count),
                        Stat("Not found", not_exists_count)
                        ).toDF("Matching Stats","Number").withColumn("%",concat(lit(($"Number"/orig_count*100)),lit("%")))

matchingStats.write.
  format("com.crealytics.spark.excel").
  option("dataAddress", "'Stats'!A17").
  option("useHeader", "true").
  option("dateFormat", "yy-mmm-d"). // Optional, default: yy-m-d h:mm
  option("timestampFormat", "mm-dd-yyyy hh:mm:ss"). // Optional, default: yyyy-mm-dd hh:mm:ss.000
  mode("append"). // Optional, default: overwrite.
  save(temp_file)

//Content statistics
val contentStats = Seq(Stat("Alive Consumers",alive_consumers),
                       Stat("Deceased Consumers", dead_consumers),
                       Stat("Male Consumers", male_consumers),
                       Stat("Female Consumers", female_consumers),
                       Stat("Email Address",has_email),
                       Stat("IP address", has_ip_address)
                       ).toDF("Content Stats","Number").withColumn("%",concat(lit(($"Number"/orig_count*100)),lit("%")))

contentStats.write.
  format("com.crealytics.spark.excel").
  option("dataAddress", "'Stats'!A21").
  option("useHeader", "true").
  option("dateFormat", "yy-mmm-d"). // Optional, default: yy-m-d h:mm
  option("timestampFormat", "mm-dd-yyyy hh:mm:ss"). // Optional, default: yyyy-mm-dd hh:mm:ss.000
  mode("append"). // Optional, default: overwrite.
  save(temp_file)

//modify file permissions
chmod(output_dir,"777")
chmod(temp_file,"777")

val fis: FileInputStream = new FileInputStream(temp_file)
val workbook: XSSFWorkbook = new XSSFWorkbook(fis)
var fs: POIFSFileSystem = new POIFSFileSystem()
var info: EncryptionInfo = new EncryptionInfo(EncryptionMode.agile)

var enc: Encryptor = info.getEncryptor()
enc.confirmPassword(nifi_pswd)

var os: OutputStream = enc.getDataStream(fs)
workbook.write(os)
os.close()

var fos: FileOutputStream = new FileOutputStream(temp_file)
fs.writeFilesystem(fos)
fos.close()

//write stats to elasticsearch

val batchRef = "${flowfile_uuid}"
val dateReceived = "${date}"
val timeReceived = "${time}"
val clientName = "BhamDaya"
val inputFileName = "${original_filename}"
val contactDetails = "${sender}"

val inputRecords = orig_count
val matchedRecords = exists_count
val unMatchedRecords = not_exists_count
val approvedRecords = valids_count
val declinedRecords = invalid_count + duplicates_count + null_count
val outputRecords = valids_count
val dateCompleted = DateTimeFormatter.ofPattern("yyyy-MM-dd").format(LocalDateTime.now)
val timeCompleted = DateTimeFormatter.ofPattern("HH:mm:ss").format(LocalDateTime.now)

val dataframe = Seq((batchRef,dateReceived,timeReceived,clientName,inputFileName,contactDetails, inputRecords,
  matchedRecords, unMatchedRecords, approvedRecords, declinedRecords, outputRecords, dateCompleted, timeCompleted)).
toDF("BatchRef", "DateReceived", "TimeReceived", "ClientName", "InputFileName", "ContactDetails", "InputRecords", "MatchedRecords",
  "UnMatchedRecords", "ApprovedRecords", "DeclinedRecords", "OutputRecords", "DateCompleted", "TimeCompleted")

dataframe.saveToEs("batch_daily_log", es_settings)

//move file to output directory

moveFile(temp_file, output_file)
</value>
    </entry>
    <entry>
        <key>exec-spark-iactive-charset</key>
        <value>UTF-8</value>
    </entry>
    <entry>
        <key>exec-spark-iactive-status-check-interval</key>
        <value>1 sec</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>ExecuteSparkInteractive</name>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>wait</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.livy.ExecuteSparkInteractive</type>
                        </processors>
                        <processors>
                            <id>5b4312f0-f4e3-3861-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-759.248062516298</x>
<y>-158.42428652692814</y>
                            </position>
                            <versionedComponentId>c1aeb13f-4945-35b6-ac1d-2b63ccb0987e</versionedComponentId>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Input Directory</key>
        <value>
            <name>Input Directory</name>
        </value>
    </entry>
    <entry>
        <key>Recurse Subdirectories</key>
        <value>
            <name>Recurse Subdirectories</name>
        </value>
    </entry>
    <entry>
        <key>Input Directory Location</key>
        <value>
            <name>Input Directory Location</name>
        </value>
    </entry>
    <entry>
        <key>File Filter</key>
        <value>
            <name>File Filter</name>
        </value>
    </entry>
    <entry>
        <key>Path Filter</key>
        <value>
            <name>Path Filter</name>
        </value>
    </entry>
    <entry>
        <key>Include File Attributes</key>
        <value>
            <name>Include File Attributes</name>
        </value>
    </entry>
    <entry>
        <key>Minimum File Age</key>
        <value>
            <name>Minimum File Age</name>
        </value>
    </entry>
    <entry>
        <key>Maximum File Age</key>
        <value>
            <name>Maximum File Age</name>
        </value>
    </entry>
    <entry>
        <key>Minimum File Size</key>
        <value>
            <name>Minimum File Size</name>
        </value>
    </entry>
    <entry>
        <key>Maximum File Size</key>
        <value>
            <name>Maximum File Size</name>
        </value>
    </entry>
    <entry>
        <key>Ignore Hidden Files</key>
        <value>
            <name>Ignore Hidden Files</name>
        </value>
    </entry>
    <entry>
        <key>target-system-timestamp-precision</key>
        <value>
            <name>target-system-timestamp-precision</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Input Directory</key>
        <value>/tmp/data/input</value>
    </entry>
    <entry>
        <key>Recurse Subdirectories</key>
        <value>true</value>
    </entry>
    <entry>
        <key>Input Directory Location</key>
        <value>Local</value>
    </entry>
    <entry>
        <key>File Filter</key>
        <value>[^\.].*</value>
    </entry>
    <entry>
        <key>Path Filter</key>
    </entry>
    <entry>
        <key>Include File Attributes</key>
        <value>true</value>
    </entry>
    <entry>
        <key>Minimum File Age</key>
        <value>0 sec</value>
    </entry>
    <entry>
        <key>Maximum File Age</key>
    </entry>
    <entry>
        <key>Minimum File Size</key>
        <value>0 B</value>
    </entry>
    <entry>
        <key>Maximum File Size</key>
    </entry>
    <entry>
        <key>Ignore Hidden Files</key>
        <value>true</value>
    </entry>
    <entry>
        <key>target-system-timestamp-precision</key>
        <value>auto-detect</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>10 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>ListFile</name>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.ListFile</type>
                        </processors>
                        <processors>
                            <id>6c9942cc-e95e-3033-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-1348.1514754738046</x>
<y>953.2343376479644</y>
                            </position>
                            <versionedComponentId>2baec024-d2a5-3c8f-aca9-9533e5b81032</versionedComponentId>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Directory</key>
        <value>
            <name>Directory</name>
        </value>
    </entry>
    <entry>
        <key>Conflict Resolution Strategy</key>
        <value>
            <name>Conflict Resolution Strategy</name>
        </value>
    </entry>
    <entry>
        <key>Create Missing Directories</key>
        <value>
            <name>Create Missing Directories</name>
        </value>
    </entry>
    <entry>
        <key>Maximum File Count</key>
        <value>
            <name>Maximum File Count</name>
        </value>
    </entry>
    <entry>
        <key>Last Modified Time</key>
        <value>
            <name>Last Modified Time</name>
        </value>
    </entry>
    <entry>
        <key>Permissions</key>
        <value>
            <name>Permissions</name>
        </value>
    </entry>
    <entry>
        <key>Owner</key>
        <value>
            <name>Owner</name>
        </value>
    </entry>
    <entry>
        <key>Group</key>
        <value>
            <name>Group</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Directory</key>
        <value>/tmp/data/processed/${flowfile_uuid}/</value>
    </entry>
    <entry>
        <key>Conflict Resolution Strategy</key>
        <value>replace</value>
    </entry>
    <entry>
        <key>Create Missing Directories</key>
        <value>true</value>
    </entry>
    <entry>
        <key>Maximum File Count</key>
    </entry>
    <entry>
        <key>Last Modified Time</key>
    </entry>
    <entry>
        <key>Permissions</key>
        <value>777</value>
    </entry>
    <entry>
        <key>Owner</key>
    </entry>
    <entry>
        <key>Group</key>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>PutFile</name>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.PutFile</type>
                        </processors>
                        <processors>
                            <id>6da6e4e8-7897-3127-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-758.6004322966987</x>
<y>209.62668167005097</y>
                            </position>
                            <versionedComponentId>6b63f25f-c51d-36e9-9c5f-8b719d4f15be</versionedComponentId>
                            <bundle>
<artifact>nifi-update-attribute-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Delete Attributes Expression</key>
        <value>
            <name>Delete Attributes Expression</name>
        </value>
    </entry>
    <entry>
        <key>Store State</key>
        <value>
            <name>Store State</name>
        </value>
    </entry>
    <entry>
        <key>Stateful Variables Initial Value</key>
        <value>
            <name>Stateful Variables Initial Value</name>
        </value>
    </entry>
    <entry>
        <key>date</key>
        <value>
            <name>date</name>
        </value>
    </entry>
    <entry>
        <key>flowfile_uuid</key>
        <value>
            <name>flowfile_uuid</name>
        </value>
    </entry>
    <entry>
        <key>original_filename</key>
        <value>
            <name>original_filename</name>
        </value>
    </entry>
    <entry>
        <key>sender</key>
        <value>
            <name>sender</name>
        </value>
    </entry>
    <entry>
        <key>time</key>
        <value>
            <name>time</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Delete Attributes Expression</key>
    </entry>
    <entry>
        <key>Store State</key>
        <value>Do not store state</value>
    </entry>
    <entry>
        <key>Stateful Variables Initial Value</key>
    </entry>
    <entry>
        <key>date</key>
        <value>${filename:getDelimitedField(3, '_'):substringBeforeLast('-'):substringBeforeLast('-'):substringBeforeLast('-')}</value>
    </entry>
    <entry>
        <key>flowfile_uuid</key>
        <value>${filename:getDelimitedField(2, '_')}</value>
    </entry>
    <entry>
        <key>original_filename</key>
        <value>${filename:substringAfter('_'):substringAfter('_'):substringAfter('_')}</value>
    </entry>
    <entry>
        <key>sender</key>
        <value>${filename:getDelimitedField(1, '_')}</value>
    </entry>
    <entry>
        <key>time</key>
        <value>${filename:getDelimitedField(3, '_'):substringAfter('-'):substringAfter('-'):substringAfter('-')}</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>GetFilenameMetaData</name>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.attributes.UpdateAttribute</type>
                        </processors>
                        <processors>
                            <id>7de32b1f-aff8-3167-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-763.6262510845701</x>
<y>766.6791630383727</y>
                            </position>
                            <versionedComponentId>61b6e28e-4b05-32d6-a52f-0b213bfe9ccc</versionedComponentId>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Destination</key>
        <value>
            <name>Destination</name>
        </value>
    </entry>
    <entry>
        <key>Return Type</key>
        <value>
            <name>Return Type</name>
        </value>
    </entry>
    <entry>
        <key>Path Not Found Behavior</key>
        <value>
            <name>Path Not Found Behavior</name>
        </value>
    </entry>
    <entry>
        <key>Null Value Representation</key>
        <value>
            <name>Null Value Representation</name>
        </value>
    </entry>
    <entry>
        <key>evalue</key>
        <value>
            <name>evalue</name>
        </value>
    </entry>
    <entry>
        <key>status</key>
        <value>
            <name>status</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Destination</key>
        <value>flowfile-attribute</value>
    </entry>
    <entry>
        <key>Return Type</key>
        <value>auto-detect</value>
    </entry>
    <entry>
        <key>Path Not Found Behavior</key>
        <value>ignore</value>
    </entry>
    <entry>
        <key>Null Value Representation</key>
        <value>empty string</value>
    </entry>
    <entry>
        <key>evalue</key>
        <value>$.evalue</value>
    </entry>
    <entry>
        <key>status</key>
        <value>$.status</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>EvaluateJsonPath</name>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>matched</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>unmatched</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.EvaluateJsonPath</type>
                        </processors>
                        <processors>
                            <id>7fcfd624-0a55-3380-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-1346.049790903492</x>
<y>756.6241081557769</y>
                            </position>
                            <versionedComponentId>70622acb-8b1f-3f57-b375-f51fe23223c2</versionedComponentId>
                            <bundle>
<artifact>nifi-update-attribute-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Delete Attributes Expression</key>
        <value>
            <name>Delete Attributes Expression</name>
        </value>
    </entry>
    <entry>
        <key>Store State</key>
        <value>
            <name>Store State</name>
        </value>
    </entry>
    <entry>
        <key>Stateful Variables Initial Value</key>
        <value>
            <name>Stateful Variables Initial Value</name>
        </value>
    </entry>
    <entry>
        <key>filename</key>
        <value>
            <name>filename</name>
        </value>
    </entry>
    <entry>
        <key>flowfile_uuid</key>
        <value>
            <name>flowfile_uuid</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Delete Attributes Expression</key>
    </entry>
    <entry>
        <key>Store State</key>
        <value>Do not store state</value>
    </entry>
    <entry>
        <key>Stateful Variables Initial Value</key>
    </entry>
    <entry>
        <key>filename</key>
        <value>${filename:substringAfter('_'):substringAfter('_'):substringAfter('_')}</value>
    </entry>
    <entry>
        <key>flowfile_uuid</key>
        <value>${filename:getDelimitedField(2, '_')}</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>RemoveMetaDataFromFilename</name>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.attributes.UpdateAttribute</type>
                        </processors>
                        <processors>
                            <id>e48d31f4-a518-3cb3-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-224.96242702936115</x>
<y>199.39622319204204</y>
                            </position>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>URL</key>
        <value>
            <name>URL</name>
        </value>
    </entry>
    <entry>
        <key>Max Batch Size</key>
        <value>
            <name>Max Batch Size</name>
        </value>
    </entry>
    <entry>
        <key>Max Data to Post per Second</key>
        <value>
            <name>Max Data to Post per Second</name>
        </value>
    </entry>
    <entry>
        <key>SSL Context Service</key>
        <value>
            <identifiesControllerService>org.apache.nifi.ssl.SSLContextService</identifiesControllerService>
            <name>SSL Context Service</name>
        </value>
    </entry>
    <entry>
        <key>Username</key>
        <value>
            <name>Username</name>
        </value>
    </entry>
    <entry>
        <key>Password</key>
        <value>
            <name>Password</name>
        </value>
    </entry>
    <entry>
        <key>Send as FlowFile</key>
        <value>
            <name>Send as FlowFile</name>
        </value>
    </entry>
    <entry>
        <key>Use Chunked Encoding</key>
        <value>
            <name>Use Chunked Encoding</name>
        </value>
    </entry>
    <entry>
        <key>Compression Level</key>
        <value>
            <name>Compression Level</name>
        </value>
    </entry>
    <entry>
        <key>Connection Timeout</key>
        <value>
            <name>Connection Timeout</name>
        </value>
    </entry>
    <entry>
        <key>Data Timeout</key>
        <value>
            <name>Data Timeout</name>
        </value>
    </entry>
    <entry>
        <key>Attributes to Send as HTTP Headers (Regex)</key>
        <value>
            <name>Attributes to Send as HTTP Headers (Regex)</name>
        </value>
    </entry>
    <entry>
        <key>User Agent</key>
        <value>
            <name>User Agent</name>
        </value>
    </entry>
    <entry>
        <key>proxy-configuration-service</key>
        <value>
            <identifiesControllerService>org.apache.nifi.proxy.ProxyConfigurationService</identifiesControllerService>
            <name>proxy-configuration-service</name>
        </value>
    </entry>
    <entry>
        <key>Proxy Host</key>
        <value>
            <name>Proxy Host</name>
        </value>
    </entry>
    <entry>
        <key>Proxy Port</key>
        <value>
            <name>Proxy Port</name>
        </value>
    </entry>
    <entry>
        <key>Content-Type</key>
        <value>
            <name>Content-Type</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>URL</key>
        <value>http://livy-testingstephan.apps.zenaptix.net</value>
    </entry>
    <entry>
        <key>Max Batch Size</key>
        <value>100 MB</value>
    </entry>
    <entry>
        <key>Max Data to Post per Second</key>
    </entry>
    <entry>
        <key>SSL Context Service</key>
    </entry>
    <entry>
        <key>Username</key>
    </entry>
    <entry>
        <key>Password</key>
    </entry>
    <entry>
        <key>Send as FlowFile</key>
        <value>false</value>
    </entry>
    <entry>
        <key>Use Chunked Encoding</key>
    </entry>
    <entry>
        <key>Compression Level</key>
        <value>0</value>
    </entry>
    <entry>
        <key>Connection Timeout</key>
        <value>30 sec</value>
    </entry>
    <entry>
        <key>Data Timeout</key>
        <value>30 sec</value>
    </entry>
    <entry>
        <key>Attributes to Send as HTTP Headers (Regex)</key>
    </entry>
    <entry>
        <key>User Agent</key>
        <value>Apache-HttpClient/4.5.5 (Java/1.8.0_162)</value>
    </entry>
    <entry>
        <key>proxy-configuration-service</key>
    </entry>
    <entry>
        <key>Proxy Host</key>
    </entry>
    <entry>
        <key>Proxy Port</key>
    </entry>
    <entry>
        <key>Content-Type</key>
        <value>${mime.type}</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>PostHTTP</name>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.PostHTTP</type>
                        </processors>
                        <processors>
                            <id>ef5cf176-56a4-3721-0000-000000000000</id>
                            <parentGroupId>bf0dc036-8ecf-37f5-0000-000000000000</parentGroupId>
                            <position>
<x>-760.0493605533263</x>
<y>18.33884686437807</y>
                            </position>
                            <versionedComponentId>c694c5ac-0d85-3c17-8daa-f62b9d3b5301</versionedComponentId>
                            <bundle>
<artifact>nifi-scripting-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Script Engine</key>
        <value>
            <name>Script Engine</name>
        </value>
    </entry>
    <entry>
        <key>Script File</key>
        <value>
            <name>Script File</name>
        </value>
    </entry>
    <entry>
        <key>Script Body</key>
        <value>
            <name>Script Body</name>
        </value>
    </entry>
    <entry>
        <key>Module Directory</key>
        <value>
            <name>Module Directory</name>
        </value>
    </entry>
    <entry>
        <key>dateTime</key>
        <value>
            <name>dateTime</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Script Engine</key>
        <value>python</value>
    </entry>
    <entry>
        <key>Script File</key>
    </entry>
    <entry>
        <key>Script Body</key>
        <value>import traceback
from org.apache.nifi.processors.script import ExecuteScript
from org.apache.nifi.processor.io import StreamCallback
from org.apache.nifi.processor.io import InputStreamCallback

class GeneratePassword(StreamCallback) :
    def __init__(self) :
        pass
    def getPswd(self) :
        return self.__pswd
    def process(self, inputStream, outputStream) :
        dt = dateTime.evaluateAttributeExpressions(flowFile).getValue().split('-')
        crrntMonth = int(dt[1]) - 1
        listOfmonths = ["Jan","Feb","Mar","Apr","May","June","July","Aug","Sep","Oct","Nov","Dec"]
        mnth = listOfmonths[crrntMonth]
        self.__pswd = str("BhamDaya_" + mnth + dt[0])

flowFile = session.get()
if flowFile is not None :
    pswdGenerate = GeneratePassword()
    session.write(flowFile, pswdGenerate)
    flowFile = session.putAttribute(flowFile, "password", pswdGenerate.getPswd()) #creates attribute
    session.transfer(flowFile, ExecuteScript.REL_SUCCESS)
</value>
    </entry>
    <entry>
        <key>Module Directory</key>
    </entry>
    <entry>
        <key>dateTime</key>
        <value>${filename:getDelimitedField(3, '_')}</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>MakeWorkbookPassword</name>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>STOPPED</state>
                            <style/>
                            <type>org.apache.nifi.processors.script.ExecuteScript</type>
                        </processors>
                    </contents>
                    <name>Process Contact Details</name>
                    <variables/>
                </processGroups>
                <processGroups>
                    <id>c91db385-2eef-3b61-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-806.8757837250407</x>
                        <y>328.81815339384457</y>
                    </position>
                    <versionedComponentId>2754194b-0c3a-3c61-8a48-52a790624630</versionedComponentId>
                    <comments></comments>
                    <contents>
                        <connections>
                            <id>278ce199-5a72-37b3-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <versionedComponentId>8ffe7dc8-ae35-3159-a74d-8f9a7e78b5f0</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>c8170165-be5e-3ad2-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>eb736f33-9b38-3a83-b1a6-109398a4979d</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>3faf19b5-f39b-308e-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>b7799b16-7d38-39a0-bbf4-8e6436dbad8a</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>2a1c7bbd-9cae-365c-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <versionedComponentId>c78925f9-3e67-3116-b776-1152e13d1977</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>6cc663fb-0597-3990-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>936fa8cd-e7b3-3df1-a7fc-0332af369200</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>361e00c7-5137-3570-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>46dd039d-d075-3806-a02f-d00804e2ced9</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>673a19c8-b4ea-3953-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <versionedComponentId>11a83069-cb5b-3877-95c8-bfb2c8dcea6a</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>361e00c7-5137-3570-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>46dd039d-d075-3806-a02f-d00804e2ced9</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>c8170165-be5e-3ad2-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>eb736f33-9b38-3a83-b1a6-109398a4979d</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>9acb90e3-b0b7-36e9-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <versionedComponentId>76c8374e-2690-3e93-a5db-c477f7e9d1ff</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>b42f1617-cd4c-377d-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>f0d92bca-4176-38ba-9ffb-7b2e8af5aae1</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>361e00c7-5137-3570-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>46dd039d-d075-3806-a02f-d00804e2ced9</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <connections>
                            <id>f34e2d0e-726f-37d7-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <versionedComponentId>af5c30d0-32d3-343f-ba2c-98f3b91c76d5</versionedComponentId>
                            <backPressureDataSizeThreshold>1 GB</backPressureDataSizeThreshold>
                            <backPressureObjectThreshold>10000</backPressureObjectThreshold>
                            <destination>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>3faf19b5-f39b-308e-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>b7799b16-7d38-39a0-bbf4-8e6436dbad8a</versionedComponentId>
                            </destination>
                            <flowFileExpiration>0 sec</flowFileExpiration>
                            <labelIndex>1</labelIndex>
                            <name></name>
                            <selectedRelationships>success</selectedRelationships>
                            <source>
<groupId>c91db385-2eef-3b61-0000-000000000000</groupId>
<id>36615126-d05c-3e22-0000-000000000000</id>
<type>PROCESSOR</type>
<versionedComponentId>c68d2aa9-3a5a-3080-90ef-41353bb0f520</versionedComponentId>
                            </source>
                            <zIndex>0</zIndex>
                        </connections>
                        <processors>
                            <id>361e00c7-5137-3570-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <position>
<x>-726.0159620050358</x>
<y>996.3375522709736</y>
                            </position>
                            <versionedComponentId>46dd039d-d075-3806-a02f-d00804e2ced9</versionedComponentId>
                            <bundle>
<artifact>nifi-update-attribute-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Delete Attributes Expression</key>
        <value>
            <name>Delete Attributes Expression</name>
        </value>
    </entry>
    <entry>
        <key>Store State</key>
        <value>
            <name>Store State</name>
        </value>
    </entry>
    <entry>
        <key>Stateful Variables Initial Value</key>
        <value>
            <name>Stateful Variables Initial Value</name>
        </value>
    </entry>
    <entry>
        <key>date</key>
        <value>
            <name>date</name>
        </value>
    </entry>
    <entry>
        <key>filename</key>
        <value>
            <name>filename</name>
        </value>
    </entry>
    <entry>
        <key>flowfile_uuid</key>
        <value>
            <name>flowfile_uuid</name>
        </value>
    </entry>
    <entry>
        <key>sender</key>
        <value>
            <name>sender</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Delete Attributes Expression</key>
    </entry>
    <entry>
        <key>Store State</key>
        <value>Do not store state</value>
    </entry>
    <entry>
        <key>Stateful Variables Initial Value</key>
    </entry>
    <entry>
        <key>date</key>
        <value>${filename:getDelimitedField(3, '_')}</value>
    </entry>
    <entry>
        <key>filename</key>
        <value>${filename:substringAfter('_'):substringAfter('_'):substringAfter('_')}</value>
    </entry>
    <entry>
        <key>flowfile_uuid</key>
        <value>${filename:getDelimitedField(2, '_')}</value>
    </entry>
    <entry>
        <key>sender</key>
        <value>${filename:getDelimitedField(1, '_')}</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>GetFilenameMetaData</name>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>RUNNING</state>
                            <style/>
                            <type>org.apache.nifi.processors.attributes.UpdateAttribute</type>
                        </processors>
                        <processors>
                            <id>36615126-d05c-3e22-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <position>
<x>-720.9836784373517</x>
<y>444.2570266848602</y>
                            </position>
                            <versionedComponentId>c68d2aa9-3a5a-3080-90ef-41353bb0f520</versionedComponentId>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Input Directory</key>
        <value>
            <name>Input Directory</name>
        </value>
    </entry>
    <entry>
        <key>Recurse Subdirectories</key>
        <value>
            <name>Recurse Subdirectories</name>
        </value>
    </entry>
    <entry>
        <key>Input Directory Location</key>
        <value>
            <name>Input Directory Location</name>
        </value>
    </entry>
    <entry>
        <key>File Filter</key>
        <value>
            <name>File Filter</name>
        </value>
    </entry>
    <entry>
        <key>Path Filter</key>
        <value>
            <name>Path Filter</name>
        </value>
    </entry>
    <entry>
        <key>Include File Attributes</key>
        <value>
            <name>Include File Attributes</name>
        </value>
    </entry>
    <entry>
        <key>Minimum File Age</key>
        <value>
            <name>Minimum File Age</name>
        </value>
    </entry>
    <entry>
        <key>Maximum File Age</key>
        <value>
            <name>Maximum File Age</name>
        </value>
    </entry>
    <entry>
        <key>Minimum File Size</key>
        <value>
            <name>Minimum File Size</name>
        </value>
    </entry>
    <entry>
        <key>Maximum File Size</key>
        <value>
            <name>Maximum File Size</name>
        </value>
    </entry>
    <entry>
        <key>Ignore Hidden Files</key>
        <value>
            <name>Ignore Hidden Files</name>
        </value>
    </entry>
    <entry>
        <key>target-system-timestamp-precision</key>
        <value>
            <name>target-system-timestamp-precision</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Input Directory</key>
        <value>/tmp/data/output</value>
    </entry>
    <entry>
        <key>Recurse Subdirectories</key>
        <value>false</value>
    </entry>
    <entry>
        <key>Input Directory Location</key>
        <value>Local</value>
    </entry>
    <entry>
        <key>File Filter</key>
        <value>.*output.*\.xlsx</value>
    </entry>
    <entry>
        <key>Path Filter</key>
    </entry>
    <entry>
        <key>Include File Attributes</key>
        <value>true</value>
    </entry>
    <entry>
        <key>Minimum File Age</key>
        <value>10 sec</value>
    </entry>
    <entry>
        <key>Maximum File Age</key>
    </entry>
    <entry>
        <key>Minimum File Size</key>
        <value>0 B</value>
    </entry>
    <entry>
        <key>Maximum File Size</key>
    </entry>
    <entry>
        <key>Ignore Hidden Files</key>
        <value>true</value>
    </entry>
    <entry>
        <key>target-system-timestamp-precision</key>
        <value>auto-detect</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>ListFile</name>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>RUNNING</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.ListFile</type>
                        </processors>
                        <processors>
                            <id>3faf19b5-f39b-308e-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <position>
<x>-724.5723014842267</x>
<y>630.7831192141571</y>
                            </position>
                            <versionedComponentId>b7799b16-7d38-39a0-bbf4-8e6436dbad8a</versionedComponentId>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>File to Fetch</key>
        <value>
            <name>File to Fetch</name>
        </value>
    </entry>
    <entry>
        <key>Completion Strategy</key>
        <value>
            <name>Completion Strategy</name>
        </value>
    </entry>
    <entry>
        <key>Move Destination Directory</key>
        <value>
            <name>Move Destination Directory</name>
        </value>
    </entry>
    <entry>
        <key>Move Conflict Strategy</key>
        <value>
            <name>Move Conflict Strategy</name>
        </value>
    </entry>
    <entry>
        <key>Log level when file not found</key>
        <value>
            <name>Log level when file not found</name>
        </value>
    </entry>
    <entry>
        <key>Log level when permission denied</key>
        <value>
            <name>Log level when permission denied</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>File to Fetch</key>
        <value>${absolute.path}/${filename}</value>
    </entry>
    <entry>
        <key>Completion Strategy</key>
        <value>Delete File</value>
    </entry>
    <entry>
        <key>Move Destination Directory</key>
    </entry>
    <entry>
        <key>Move Conflict Strategy</key>
        <value>Replace File</value>
    </entry>
    <entry>
        <key>Log level when file not found</key>
        <value>ERROR</value>
    </entry>
    <entry>
        <key>Log level when permission denied</key>
        <value>ERROR</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>FetchFile</name>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>not.found</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>permission.denied</name>
                            </relationships>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>RUNNING</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.FetchFile</type>
                        </processors>
                        <processors>
                            <id>6cc663fb-0597-3990-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <position>
<x>-725.5122583344157</x>
<y>1183.487514690758</y>
                            </position>
                            <versionedComponentId>936fa8cd-e7b3-3df1-a7fc-0332af369200</versionedComponentId>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>SMTP Hostname</key>
        <value>
            <name>SMTP Hostname</name>
        </value>
    </entry>
    <entry>
        <key>SMTP Port</key>
        <value>
            <name>SMTP Port</name>
        </value>
    </entry>
    <entry>
        <key>SMTP Username</key>
        <value>
            <name>SMTP Username</name>
        </value>
    </entry>
    <entry>
        <key>SMTP Password</key>
        <value>
            <name>SMTP Password</name>
        </value>
    </entry>
    <entry>
        <key>SMTP Auth</key>
        <value>
            <name>SMTP Auth</name>
        </value>
    </entry>
    <entry>
        <key>SMTP TLS</key>
        <value>
            <name>SMTP TLS</name>
        </value>
    </entry>
    <entry>
        <key>SMTP Socket Factory</key>
        <value>
            <name>SMTP Socket Factory</name>
        </value>
    </entry>
    <entry>
        <key>SMTP X-Mailer Header</key>
        <value>
            <name>SMTP X-Mailer Header</name>
        </value>
    </entry>
    <entry>
        <key>attribute-name-regex</key>
        <value>
            <name>attribute-name-regex</name>
        </value>
    </entry>
    <entry>
        <key>Content Type</key>
        <value>
            <name>Content Type</name>
        </value>
    </entry>
    <entry>
        <key>From</key>
        <value>
            <name>From</name>
        </value>
    </entry>
    <entry>
        <key>To</key>
        <value>
            <name>To</name>
        </value>
    </entry>
    <entry>
        <key>CC</key>
        <value>
            <name>CC</name>
        </value>
    </entry>
    <entry>
        <key>BCC</key>
        <value>
            <name>BCC</name>
        </value>
    </entry>
    <entry>
        <key>Subject</key>
        <value>
            <name>Subject</name>
        </value>
    </entry>
    <entry>
        <key>Message</key>
        <value>
            <name>Message</name>
        </value>
    </entry>
    <entry>
        <key>email-ff-content-as-message</key>
        <value>
            <name>email-ff-content-as-message</name>
        </value>
    </entry>
    <entry>
        <key>Attach File</key>
        <value>
            <name>Attach File</name>
        </value>
    </entry>
    <entry>
        <key>Include All Attributes In Message</key>
        <value>
            <name>Include All Attributes In Message</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>SMTP Hostname</key>
        <value>smtp.gmail.com</value>
    </entry>
    <entry>
        <key>SMTP Port</key>
        <value>465</value>
    </entry>
    <entry>
        <key>SMTP Username</key>
        <value>${nifiProcessorEmail}</value>
    </entry>
    <entry>
        <key>SMTP Password</key>
    </entry>
    <entry>
        <key>SMTP Auth</key>
        <value>true</value>
    </entry>
    <entry>
        <key>SMTP TLS</key>
        <value>false</value>
    </entry>
    <entry>
        <key>SMTP Socket Factory</key>
        <value>javax.net.ssl.SSLSocketFactory</value>
    </entry>
    <entry>
        <key>SMTP X-Mailer Header</key>
        <value>NiFi</value>
    </entry>
    <entry>
        <key>attribute-name-regex</key>
    </entry>
    <entry>
        <key>Content Type</key>
        <value>text/plain</value>
    </entry>
    <entry>
        <key>From</key>
        <value>${nifiProcessorEmail}</value>
    </entry>
    <entry>
        <key>To</key>
        <value>${batchManagerEmail}</value>
    </entry>
    <entry>
        <key>CC</key>
    </entry>
    <entry>
        <key>BCC</key>
    </entry>
    <entry>
        <key>Subject</key>
        <value>Approval Needed for ${filename}</value>
    </entry>
    <entry>
        <key>Message</key>
        <value>This message was automatically generated by a Nifi Pipeline.

Please respond with a simple "yes" or "no" to this email if the attachment is valid.

Details:
Sender: ${sender}
UUID: ${flowfile_uuid}
Date: ${date}
Filename: ${filename}
Password: ${password}</value>
    </entry>
    <entry>
        <key>email-ff-content-as-message</key>
        <value>false</value>
    </entry>
    <entry>
        <key>Attach File</key>
        <value>true</value>
    </entry>
    <entry>
        <key>Include All Attributes In Message</key>
        <value>false</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>PutEmail</name>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>RUNNING</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.PutEmail</type>
                        </processors>
                        <processors>
                            <id>b42f1617-cd4c-377d-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <position>
<x>-141.19262793345592</x>
<y>1005.6413188994591</y>
                            </position>
                            <versionedComponentId>f0d92bca-4176-38ba-9ffb-7b2e8af5aae1</versionedComponentId>
                            <bundle>
<artifact>nifi-standard-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Directory</key>
        <value>
            <name>Directory</name>
        </value>
    </entry>
    <entry>
        <key>Conflict Resolution Strategy</key>
        <value>
            <name>Conflict Resolution Strategy</name>
        </value>
    </entry>
    <entry>
        <key>Create Missing Directories</key>
        <value>
            <name>Create Missing Directories</name>
        </value>
    </entry>
    <entry>
        <key>Maximum File Count</key>
        <value>
            <name>Maximum File Count</name>
        </value>
    </entry>
    <entry>
        <key>Last Modified Time</key>
        <value>
            <name>Last Modified Time</name>
        </value>
    </entry>
    <entry>
        <key>Permissions</key>
        <value>
            <name>Permissions</name>
        </value>
    </entry>
    <entry>
        <key>Owner</key>
        <value>
            <name>Owner</name>
        </value>
    </entry>
    <entry>
        <key>Group</key>
        <value>
            <name>Group</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Directory</key>
        <value>/tmp/data/processed/${flowfile_uuid}/</value>
    </entry>
    <entry>
        <key>Conflict Resolution Strategy</key>
        <value>replace</value>
    </entry>
    <entry>
        <key>Create Missing Directories</key>
        <value>true</value>
    </entry>
    <entry>
        <key>Maximum File Count</key>
    </entry>
    <entry>
        <key>Last Modified Time</key>
    </entry>
    <entry>
        <key>Permissions</key>
        <value>777</value>
    </entry>
    <entry>
        <key>Owner</key>
    </entry>
    <entry>
        <key>Group</key>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>PutFile</name>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>failure</name>
                            </relationships>
                            <relationships>
<autoTerminate>true</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>RUNNING</state>
                            <style/>
                            <type>org.apache.nifi.processors.standard.PutFile</type>
                        </processors>
                        <processors>
                            <id>c8170165-be5e-3ad2-0000-000000000000</id>
                            <parentGroupId>c91db385-2eef-3b61-0000-000000000000</parentGroupId>
                            <position>
<x>-729.9123033434639</x>
<y>814.8886818503879</y>
                            </position>
                            <versionedComponentId>eb736f33-9b38-3a83-b1a6-109398a4979d</versionedComponentId>
                            <bundle>
<artifact>nifi-update-attribute-nar</artifact>
<group>org.apache.nifi</group>
<version>1.7.1</version>
                            </bundle>
                            <config>
<bulletinLevel>WARN</bulletinLevel>
<comments></comments>
<concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
<descriptors>
    <entry>
        <key>Delete Attributes Expression</key>
        <value>
            <name>Delete Attributes Expression</name>
        </value>
    </entry>
    <entry>
        <key>Store State</key>
        <value>
            <name>Store State</name>
        </value>
    </entry>
    <entry>
        <key>Stateful Variables Initial Value</key>
        <value>
            <name>Stateful Variables Initial Value</name>
        </value>
    </entry>
    <entry>
        <key>filename</key>
        <value>
            <name>filename</name>
        </value>
    </entry>
    <entry>
        <key>password</key>
        <value>
            <name>password</name>
        </value>
    </entry>
</descriptors>
<executionNode>ALL</executionNode>
<lossTolerant>false</lossTolerant>
<penaltyDuration>30 sec</penaltyDuration>
<properties>
    <entry>
        <key>Delete Attributes Expression</key>
    </entry>
    <entry>
        <key>Store State</key>
        <value>Do not store state</value>
    </entry>
    <entry>
        <key>Stateful Variables Initial Value</key>
    </entry>
    <entry>
        <key>filename</key>
        <value>${filename:substringAfter('__')}</value>
    </entry>
    <entry>
        <key>password</key>
        <value>${filename:substringBefore('__')}</value>
    </entry>
</properties>
<runDurationMillis>0</runDurationMillis>
<schedulingPeriod>0 sec</schedulingPeriod>
<schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
<yieldDuration>1 sec</yieldDuration>
                            </config>
                            <executionNodeRestricted>false</executionNodeRestricted>
                            <name>GetPassword</name>
                            <relationships>
<autoTerminate>false</autoTerminate>
<name>success</name>
                            </relationships>
                            <state>RUNNING</state>
                            <style/>
                            <type>org.apache.nifi.processors.attributes.UpdateAttribute</type>
                        </processors>
                    </contents>
                    <name>Send to Batch Manager</name>
                    <variables/>
                </processGroups>
                <processors>
                    <id>236b1af2-94be-3229-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1935.7561979114064</x>
                        <y>1091.4054747561336</y>
                    </position>
                    <versionedComponentId>9a048a80-ac29-3745-8709-0673eb445a89</versionedComponentId>
                    <bundle>
                        <artifact>nifi-update-attribute-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Delete Attributes Expression</key>
<value>
    <name>Delete Attributes Expression</name>
</value>
                            </entry>
                            <entry>
<key>Store State</key>
<value>
    <name>Store State</name>
</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
<value>
    <name>Stateful Variables Initial Value</name>
</value>
                            </entry>
                            <entry>
<key>filename</key>
<value>
    <name>filename</name>
</value>
                            </entry>
                            <entry>
<key>sender_uuid</key>
<value>
    <name>sender_uuid</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Delete Attributes Expression</key>
                            </entry>
                            <entry>
<key>Store State</key>
<value>Do not store state</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
                            </entry>
                            <entry>
<key>filename</key>
<value>${filename:replace(${filename},${sender_filename:trim()})}</value>
                            </entry>
                            <entry>
<key>sender_uuid</key>
<value>${sender_uuid:replace(${sender_uuid},${sender_uuid:trim()})}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>UpdateAttribute</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.attributes.UpdateAttribute</type>
                </processors>
                <processors>
                    <id>2a609d17-18fc-3210-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-2161.7566893666267</x>
                        <y>311.11386889865736</y>
                    </position>
                    <versionedComponentId>86ef452b-68e0-3a6a-9936-75f51f16d006</versionedComponentId>
                    <bundle>
                        <artifact>nifi-email-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>CAPTURED_HEADERS</key>
<value>
    <name>CAPTURED_HEADERS</name>
</value>
                            </entry>
                            <entry>
<key>STRICT_ADDRESS_PARSING</key>
<value>
    <name>STRICT_ADDRESS_PARSING</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>CAPTURED_HEADERS</key>
<value>x-mailer</value>
                            </entry>
                            <entry>
<key>STRICT_ADDRESS_PARSING</key>
<value>true</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>ExtractEmailHeaders</name>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>failure</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.email.ExtractEmailHeaders</type>
                </processors>
                <processors>
                    <id>2e05ab39-1cac-355e-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-2161.691568560724</x>
                        <y>493.76220159240074</y>
                    </position>
                    <versionedComponentId>c11fba1a-a8b6-33d0-888c-ece60f695697</versionedComponentId>
                    <bundle>
                        <artifact>nifi-scripting-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Script Engine</key>
<value>
    <name>Script Engine</name>
</value>
                            </entry>
                            <entry>
<key>Script File</key>
<value>
    <name>Script File</name>
</value>
                            </entry>
                            <entry>
<key>Script Body</key>
<value>
    <name>Script Body</name>
</value>
                            </entry>
                            <entry>
<key>Module Directory</key>
<value>
    <name>Module Directory</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Script Engine</key>
<value>python</value>
                            </entry>
                            <entry>
<key>Script File</key>
                            </entry>
                            <entry>
<key>Script Body</key>
<value>import email
import mimetypes
from email.parser import Parser
from org.apache.commons.io import IOUtils
from java.nio.charset import StandardCharsets
from java.io import BufferedReader, InputStreamReader
from org.apache.nifi.processors.script import ExecuteScript
from org.apache.nifi.processor.io import InputStreamCallback
from org.apache.nifi.processor.io import StreamCallback

class PyInputStreamCallback(InputStreamCallback):
    _text = None

    def __init__(self):
        pass

    def getText(self) : 
        return self._text

    def process(self, inputStream):
        self._text = IOUtils.toString(inputStream, StandardCharsets.UTF_8)

flowFile = session.get()
if flowFile is not None :
    reader = PyInputStreamCallback()
    session.read(flowFile, reader)

    msg = email.message_from_string(reader.getText())
    body = ""

    if msg.is_multipart():
        for part in msg.walk():
            ctype = part.get_content_type()
            cdispo = str(part.get('Content-Disposition'))

            if ctype == 'text/plain' and 'attachment' not in cdispo:
                body = part.get_payload(decode=True)  # decode
                break
    else:
        body = msg.get_payload(decode=True)

    flowFile = session.putAttribute(flowFile, 'msgbody', body.decode('utf-8', 'ignore'))

    session.transfer(flowFile, ExecuteScript.REL_SUCCESS)</value>
                            </entry>
                            <entry>
<key>Module Directory</key>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>EmailBodyToAttribute</name>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>failure</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.script.ExecuteScript</type>
                </processors>
                <processors>
                    <id>33c40db1-b0fa-3fa0-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1366.2849709341212</x>
                        <y>1151.3914120011118</y>
                    </position>
                    <versionedComponentId>4311cceb-a7a0-3bd1-aa2e-ec1091102763</versionedComponentId>
                    <bundle>
                        <artifact>nifi-update-attribute-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Delete Attributes Expression</key>
<value>
    <name>Delete Attributes Expression</name>
</value>
                            </entry>
                            <entry>
<key>Store State</key>
<value>
    <name>Store State</name>
</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
<value>
    <name>Stateful Variables Initial Value</name>
</value>
                            </entry>
                            <entry>
<key>filename</key>
<value>
    <name>filename</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Delete Attributes Expression</key>
                            </entry>
                            <entry>
<key>Store State</key>
<value>Do not store state</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
                            </entry>
                            <entry>
<key>filename</key>
<value>${filename:prepend('_'):prepend(${now():format("yyyy-MM-dd-HH-mm-ss")}):prepend('_'):prepend(${UUID()}):prepend('_'):prepend(${email.headers.from.0})}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>RenameFileToIncludeDetails</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.attributes.UpdateAttribute</type>
                </processors>
                <processors>
                    <id>498a584a-b8f7-3810-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-2161.929541210454</x>
                        <y>681.0660500357576</y>
                    </position>
                    <versionedComponentId>62f19e4a-9abe-3c93-9055-66d6ae302e65</versionedComponentId>
                    <bundle>
                        <artifact>nifi-update-attribute-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Delete Attributes Expression</key>
<value>
    <name>Delete Attributes Expression</name>
</value>
                            </entry>
                            <entry>
<key>Store State</key>
<value>
    <name>Store State</name>
</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
<value>
    <name>Stateful Variables Initial Value</name>
</value>
                            </entry>
                            <entry>
<key>password</key>
<value>
    <name>password</name>
</value>
                            </entry>
                            <entry>
<key>sender_address</key>
<value>
    <name>sender_address</name>
</value>
                            </entry>
                            <entry>
<key>sender_date</key>
<value>
    <name>sender_date</name>
</value>
                            </entry>
                            <entry>
<key>sender_filename</key>
<value>
    <name>sender_filename</name>
</value>
                            </entry>
                            <entry>
<key>sender_uuid</key>
<value>
    <name>sender_uuid</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Delete Attributes Expression</key>
                            </entry>
                            <entry>
<key>Store State</key>
<value>Do not store state</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
                            </entry>
                            <entry>
<key>password</key>
<value>${msgbody:substringAfter('Password: '):substringBefore('\n')}</value>
                            </entry>
                            <entry>
<key>sender_address</key>
<value>${msgbody:substringAfter('Sender: '):substringBefore('\n')}</value>
                            </entry>
                            <entry>
<key>sender_date</key>
<value>${msgbody:substringAfter('Date: '):substringBefore('\n')}</value>
                            </entry>
                            <entry>
<key>sender_filename</key>
<value>${msgbody:substringAfter('Filename: '):substringBefore('\n')}</value>
                            </entry>
                            <entry>
<key>sender_uuid</key>
<value>${msgbody:substringAfter('UUID: '):substringBefore('\n')}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>AddClientDetailsToAttribute</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.attributes.UpdateAttribute</type>
                </processors>
                <processors>
                    <id>5337b835-7033-3254-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1354.2455652191816</x>
                        <y>278.6922113460315</y>
                    </position>
                    <versionedComponentId>571c9ab8-678e-3270-8b76-841f4ad4c660</versionedComponentId>
                    <bundle>
                        <artifact>nifi-email-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>CAPTURED_HEADERS</key>
<value>
    <name>CAPTURED_HEADERS</name>
</value>
                            </entry>
                            <entry>
<key>STRICT_ADDRESS_PARSING</key>
<value>
    <name>STRICT_ADDRESS_PARSING</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>CAPTURED_HEADERS</key>
<value>x-mailer</value>
                            </entry>
                            <entry>
<key>STRICT_ADDRESS_PARSING</key>
<value>true</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>ExtractEmailHeaders</name>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>failure</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.email.ExtractEmailHeaders</type>
                </processors>
                <processors>
                    <id>546fd60d-6557-3a2b-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1365.8504758937538</x>
                        <y>794.4947813759352</y>
                    </position>
                    <versionedComponentId>55d095c5-04c7-395e-9a96-396ea24a5a24</versionedComponentId>
                    <bundle>
                        <artifact>nifi-standard-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Routing Strategy</key>
<value>
    <name>Routing Strategy</name>
</value>
                            </entry>
                            <entry>
<key>required mail</key>
<value>
    <name>required mail</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Routing Strategy</key>
<value>Route to 'match' if any matches</value>
                            </entry>
                            <entry>
<key>required mail</key>
<value>${anyMatchingAttribute("filename"):contains(".xlsx")}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>RouteOnlyApplicableAttachments</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>matched</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>unmatched</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.standard.RouteOnAttribute</type>
                </processors>
                <processors>
                    <id>5d82c796-0321-3bdb-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1935.1342730449787</x>
                        <y>1289.7936330681114</y>
                    </position>
                    <versionedComponentId>5ef2ac3f-6f15-3127-ae67-20138737da41</versionedComponentId>
                    <bundle>
                        <artifact>nifi-scripting-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Script Engine</key>
<value>
    <name>Script Engine</name>
</value>
                            </entry>
                            <entry>
<key>Script File</key>
<value>
    <name>Script File</name>
</value>
                            </entry>
                            <entry>
<key>Script Body</key>
<value>
    <name>Script Body</name>
</value>
                            </entry>
                            <entry>
<key>Module Directory</key>
<value>
    <name>Module Directory</name>
</value>
                            </entry>
                            <entry>
<key>nifiprocessoremail</key>
<value>
    <name>nifiprocessoremail</name>
</value>
                            </entry>
                            <entry>
<key>nifiprocessoremailpswd</key>
<value>
    <name>nifiprocessoremailpswd</name>
</value>
                            </entry>
                            <entry>
<key>outputfilename</key>
<value>
    <name>outputfilename</name>
</value>
                            </entry>
                            <entry>
<key>password</key>
<value>
    <name>password</name>
</value>
                            </entry>
                            <entry>
<key>sender_address</key>
<value>
    <name>sender_address</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Script Engine</key>
<value>python</value>
                            </entry>
                            <entry>
<key>Script File</key>
                            </entry>
                            <entry>
<key>Script Body</key>
<value>import os
import smtplib
import java.io
from java.nio.charset import StandardCharsets
from org.apache.commons.io import IOUtils
from org.apache.nifi.processors.script import ExecuteScript
from org.apache.nifi.processor.io import InputStreamCallback
from org.apache.nifi.processor.io import StreamCallback
from email.MIMEMultipart import MIMEMultipart
from email.MIMEText import MIMEText
from email.MIMEImage import MIMEImage
from email.MIMEBase import MIMEBase
from email import Encoders

class PyInputStreamCallback(InputStreamCallback):
    _text = None

    def __init__(self):
        pass

    def process(self, inputStream):
        self._text = IOUtils.toString(inputStream, StandardCharsets.UTF_8)

#Set up crap for the attachments
flowFile = session.get()
files = "/tmp/data/processed/" + outputfilename.evaluateAttributeExpressions(flowFile).getValue() + "/"
filenames = [os.path.join(files, f) for f in os.listdir(files)]
#print filenames

#Set up users for email
gmail_user = nifiprocessoremail.evaluateAttributeExpressions().getValue()
gmail_pwd = nifiprocessoremailpswd.evaluateAttributeExpressions().getValue()
recipients = [sender_address.evaluateAttributeExpressions(flowFile).getValue()]
psw = password.evaluateAttributeExpressions(flowFile).getValue()

#Create Module
def mail(to, subject, text, attach):
   msg = MIMEMultipart()
   msg['From'] = gmail_user
   msg['To'] = ", ".join(recipients)
   msg['Subject'] = subject

   msg.attach(MIMEText(text))

   #get all the attachments
   for file in filenames:
      part = MIMEBase('application', 'octet-stream')
      part.set_payload(open(file, 'rb').read())
      Encoders.encode_base64(part)
      part.add_header('Content-Disposition', 'attachment; filename="%s"' % os.path.basename(file))
      msg.attach(part)

   mailServer = smtplib.SMTP("smtp.gmail.com", 587)
   mailServer.ehlo()
   mailServer.starttls()
   mailServer.ehlo()
   mailServer.login(gmail_user, gmail_pwd)
   mailServer.sendmail(gmail_user, to, msg.as_string())
   # Should be mailServer.quit(), but that crashes...
   mailServer.close()

#send it
mail(recipients,
   "Todays report",
   "Test email\nPassword: " + psw,
   filenames)

session.transfer(flowFile, ExecuteScript.REL_SUCCESS)
</value>
                            </entry>
                            <entry>
<key>Module Directory</key>
                            </entry>
                            <entry>
<key>nifiprocessoremail</key>
<value>${nifiProcessorEmail}</value>
                            </entry>
                            <entry>
<key>nifiprocessoremailpswd</key>
<value>${nifiProcessorEmailPswd}</value>
                            </entry>
                            <entry>
<key>outputfilename</key>
<value>${sender_uuid}</value>
                            </entry>
                            <entry>
<key>password</key>
<value>${password}</value>
                            </entry>
                            <entry>
<key>sender_address</key>
<value>${sender_address}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>SendResponseEmailScript</name>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>failure</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.script.ExecuteScript</type>
                </processors>
                <processors>
                    <id>5d9f7b8e-8ee5-3f79-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-2376.436698797166</x>
                        <y>1090.9093679678124</y>
                    </position>
                    <versionedComponentId>f906871b-27d4-36b4-886c-8325d07168ed</versionedComponentId>
                    <bundle>
                        <artifact>nifi-update-attribute-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Delete Attributes Expression</key>
<value>
    <name>Delete Attributes Expression</name>
</value>
                            </entry>
                            <entry>
<key>Store State</key>
<value>
    <name>Store State</name>
</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
<value>
    <name>Stateful Variables Initial Value</name>
</value>
                            </entry>
                            <entry>
<key>filename</key>
<value>
    <name>filename</name>
</value>
                            </entry>
                            <entry>
<key>sender_uuid</key>
<value>
    <name>sender_uuid</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Delete Attributes Expression</key>
                            </entry>
                            <entry>
<key>Store State</key>
<value>Do not store state</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
                            </entry>
                            <entry>
<key>filename</key>
<value>${filename:replace(${filename},${sender_filename:trim()})}</value>
                            </entry>
                            <entry>
<key>sender_uuid</key>
<value>${sender_uuid:replace(${sender_uuid},${sender_uuid:trim()})}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>UpdateAttribute</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.attributes.UpdateAttribute</type>
                </processors>
                <processors>
                    <id>7160e47c-3c05-339b-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1362.4774988129316</x>
                        <y>619.6229669612658</y>
                    </position>
                    <versionedComponentId>e3117c86-3eb3-3cb6-a57a-b8a0e05232f0</versionedComponentId>
                    <bundle>
                        <artifact>nifi-email-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors/>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties/>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>ExtractEmailAttachments</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>attachments</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>failure</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>original</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.email.ExtractEmailAttachments</type>
                </processors>
                <processors>
                    <id>7458c830-857d-3299-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-2161.135772329896</x>
                        <y>857.5279313241447</y>
                    </position>
                    <versionedComponentId>afbb2094-add9-3e24-873b-820ec3e5ebf8</versionedComponentId>
                    <bundle>
                        <artifact>nifi-standard-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Routing Strategy</key>
<value>
    <name>Routing Strategy</name>
</value>
                            </entry>
                            <entry>
<key>no</key>
<value>
    <name>no</name>
</value>
                            </entry>
                            <entry>
<key>yes</key>
<value>
    <name>yes</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Routing Strategy</key>
<value>Route to Property name</value>
                            </entry>
                            <entry>
<key>no</key>
<value>${anyMatchingAttribute("msgbody"):substring(0,3):toLower():contains("no")}</value>
                            </entry>
                            <entry>
<key>yes</key>
<value>${anyMatchingAttribute("msgbody"):substring(0,3):toLower():contains("yes")}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>RouteOnBatchManagerResponse</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>no</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>unmatched</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>yes</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.standard.RouteOnAttribute</type>
                </processors>
                <processors>
                    <id>7eab20ce-b8f4-3a49-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1370.0100096313522</x>
                        <y>1315.5423951019347</y>
                    </position>
                    <versionedComponentId>66b71b2e-c3be-3acf-8ae1-185274618d42</versionedComponentId>
                    <bundle>
                        <artifact>nifi-standard-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Directory</key>
<value>
    <name>Directory</name>
</value>
                            </entry>
                            <entry>
<key>Conflict Resolution Strategy</key>
<value>
    <name>Conflict Resolution Strategy</name>
</value>
                            </entry>
                            <entry>
<key>Create Missing Directories</key>
<value>
    <name>Create Missing Directories</name>
</value>
                            </entry>
                            <entry>
<key>Maximum File Count</key>
<value>
    <name>Maximum File Count</name>
</value>
                            </entry>
                            <entry>
<key>Last Modified Time</key>
<value>
    <name>Last Modified Time</name>
</value>
                            </entry>
                            <entry>
<key>Permissions</key>
<value>
    <name>Permissions</name>
</value>
                            </entry>
                            <entry>
<key>Owner</key>
<value>
    <name>Owner</name>
</value>
                            </entry>
                            <entry>
<key>Group</key>
<value>
    <name>Group</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Directory</key>
<value>/tmp/data/input</value>
                            </entry>
                            <entry>
<key>Conflict Resolution Strategy</key>
<value>replace</value>
                            </entry>
                            <entry>
<key>Create Missing Directories</key>
<value>true</value>
                            </entry>
                            <entry>
<key>Maximum File Count</key>
                            </entry>
                            <entry>
<key>Last Modified Time</key>
                            </entry>
                            <entry>
<key>Permissions</key>
<value>777</value>
                            </entry>
                            <entry>
<key>Owner</key>
                            </entry>
                            <entry>
<key>Group</key>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>PutFile</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>failure</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.standard.PutFile</type>
                </processors>
                <processors>
                    <id>93dcd10c-a8c7-3a6b-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-818.0368651001024</x>
                        <y>1324.4641480316222</y>
                    </position>
                    <versionedComponentId>a8a350a0-f91e-3d1c-8b4f-b6e986825487</versionedComponentId>
                    <bundle>
                        <artifact>nifi-standard-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>SMTP Hostname</key>
<value>
    <name>SMTP Hostname</name>
</value>
                            </entry>
                            <entry>
<key>SMTP Port</key>
<value>
    <name>SMTP Port</name>
</value>
                            </entry>
                            <entry>
<key>SMTP Username</key>
<value>
    <name>SMTP Username</name>
</value>
                            </entry>
                            <entry>
<key>SMTP Password</key>
<value>
    <name>SMTP Password</name>
</value>
                            </entry>
                            <entry>
<key>SMTP Auth</key>
<value>
    <name>SMTP Auth</name>
</value>
                            </entry>
                            <entry>
<key>SMTP TLS</key>
<value>
    <name>SMTP TLS</name>
</value>
                            </entry>
                            <entry>
<key>SMTP Socket Factory</key>
<value>
    <name>SMTP Socket Factory</name>
</value>
                            </entry>
                            <entry>
<key>SMTP X-Mailer Header</key>
<value>
    <name>SMTP X-Mailer Header</name>
</value>
                            </entry>
                            <entry>
<key>attribute-name-regex</key>
<value>
    <name>attribute-name-regex</name>
</value>
                            </entry>
                            <entry>
<key>Content Type</key>
<value>
    <name>Content Type</name>
</value>
                            </entry>
                            <entry>
<key>From</key>
<value>
    <name>From</name>
</value>
                            </entry>
                            <entry>
<key>To</key>
<value>
    <name>To</name>
</value>
                            </entry>
                            <entry>
<key>CC</key>
<value>
    <name>CC</name>
</value>
                            </entry>
                            <entry>
<key>BCC</key>
<value>
    <name>BCC</name>
</value>
                            </entry>
                            <entry>
<key>Subject</key>
<value>
    <name>Subject</name>
</value>
                            </entry>
                            <entry>
<key>Message</key>
<value>
    <name>Message</name>
</value>
                            </entry>
                            <entry>
<key>email-ff-content-as-message</key>
<value>
    <name>email-ff-content-as-message</name>
</value>
                            </entry>
                            <entry>
<key>Attach File</key>
<value>
    <name>Attach File</name>
</value>
                            </entry>
                            <entry>
<key>Include All Attributes In Message</key>
<value>
    <name>Include All Attributes In Message</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>SMTP Hostname</key>
<value>smtp.gmail.com</value>
                            </entry>
                            <entry>
<key>SMTP Port</key>
<value>465</value>
                            </entry>
                            <entry>
<key>SMTP Username</key>
<value>${nifiProcessorEmail}</value>
                            </entry>
                            <entry>
<key>SMTP Password</key>
                            </entry>
                            <entry>
<key>SMTP Auth</key>
<value>true</value>
                            </entry>
                            <entry>
<key>SMTP TLS</key>
<value>false</value>
                            </entry>
                            <entry>
<key>SMTP Socket Factory</key>
<value>javax.net.ssl.SSLSocketFactory</value>
                            </entry>
                            <entry>
<key>SMTP X-Mailer Header</key>
<value>NiFi</value>
                            </entry>
                            <entry>
<key>attribute-name-regex</key>
                            </entry>
                            <entry>
<key>Content Type</key>
<value>text/plain</value>
                            </entry>
                            <entry>
<key>From</key>
<value>${nifiProcessorEmail}</value>
                            </entry>
                            <entry>
<key>To</key>
<value>${batchManagerEmail}</value>
                            </entry>
                            <entry>
<key>CC</key>
                            </entry>
                            <entry>
<key>BCC</key>
                            </entry>
                            <entry>
<key>Subject</key>
<value>Message from NiFi</value>
                            </entry>
                            <entry>
<key>Message</key>
<value>This is a Nifi Message, file could not be saved to disk</value>
                            </entry>
                            <entry>
<key>email-ff-content-as-message</key>
<value>false</value>
                            </entry>
                            <entry>
<key>Attach File</key>
<value>false</value>
                            </entry>
                            <entry>
<key>Include All Attributes In Message</key>
<value>false</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>PutEmail</name>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>failure</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.standard.PutEmail</type>
                </processors>
                <processors>
                    <id>b1a39434-312a-3ccf-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-2372.5935825244887</x>
                        <y>1290.4081219829152</y>
                    </position>
                    <versionedComponentId>b99d0193-389a-3bf6-bdc2-4448c72b0dd3</versionedComponentId>
                    <bundle>
                        <artifact>nifi-scripting-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Script Engine</key>
<value>
    <name>Script Engine</name>
</value>
                            </entry>
                            <entry>
<key>Script File</key>
<value>
    <name>Script File</name>
</value>
                            </entry>
                            <entry>
<key>Script Body</key>
<value>
    <name>Script Body</name>
</value>
                            </entry>
                            <entry>
<key>Module Directory</key>
<value>
    <name>Module Directory</name>
</value>
                            </entry>
                            <entry>
<key>nifiprocessoremail</key>
<value>
    <name>nifiprocessoremail</name>
</value>
                            </entry>
                            <entry>
<key>nifiprocessoremailpswd</key>
<value>
    <name>nifiprocessoremailpswd</name>
</value>
                            </entry>
                            <entry>
<key>outputfilename</key>
<value>
    <name>outputfilename</name>
</value>
                            </entry>
                            <entry>
<key>password</key>
<value>
    <name>password</name>
</value>
                            </entry>
                            <entry>
<key>sender_address</key>
<value>
    <name>sender_address</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Script Engine</key>
<value>python</value>
                            </entry>
                            <entry>
<key>Script File</key>
                            </entry>
                            <entry>
<key>Script Body</key>
<value>import os 
import smtplib
import java.io
from java.nio.charset import StandardCharsets
from org.apache.commons.io import IOUtils
from org.apache.nifi.processors.script import ExecuteScript
from org.apache.nifi.processor.io import InputStreamCallback
from org.apache.nifi.processor.io import StreamCallback
from email.MIMEMultipart import MIMEMultipart
from email.MIMEText import MIMEText
from email.MIMEImage import MIMEImage
from email.MIMEBase import MIMEBase
from email import Encoders

class PyInputStreamCallback(InputStreamCallback):
    _text = None

    def __init__(self):
        pass

    def process(self, inputStream):
        self._text = IOUtils.toString(inputStream, StandardCharsets.UTF_8)

#Set up crap for the attachments
flowFile = session.get()
files = "/tmp/data/processed/" + outputfilename.evaluateAttributeExpressions(flowFile).getValue() + "/"
filenames = [os.path.join(files, f) for f in os.listdir(files)]
#print filenames

#Set up users for email
gmail_user = nifiprocessoremail.evaluateAttributeExpressions().getValue()
gmail_pwd = nifiprocessoremailpswd.evaluateAttributeExpressions().getValue()
recipients = [sender_address.evaluateAttributeExpressions(flowFile).getValue()]
psw = password.evaluateAttributeExpressions(flowFile).getValue()

#Create Module
def mail(to, subject, text, attach):
   msg = MIMEMultipart()
   msg['From'] = gmail_user
   msg['To'] = ", ".join(recipients)
   msg['Subject'] = subject

   msg.attach(MIMEText(text))

   #get all the attachments
   for file in filenames:
      part = MIMEBase('application', 'octet-stream')
      part.set_payload(open(file, 'rb').read())
      Encoders.encode_base64(part)
      part.add_header('Content-Disposition', 'attachment; filename="%s"' % os.path.basename(file))
      msg.attach(part)

   mailServer = smtplib.SMTP("smtp.gmail.com", 587)
   mailServer.ehlo()
   mailServer.starttls()
   mailServer.ehlo()
   mailServer.login(gmail_user, gmail_pwd)
   mailServer.sendmail(gmail_user, to, msg.as_string())
   # Should be mailServer.quit(), but that crashes...
   mailServer.close()

#send it
mail(recipients,
   "Report Declined",
   "The BatchManager has declined your report\nPassword: " + psw,
   filenames)

session.transfer(flowFile, ExecuteScript.REL_SUCCESS)</value>
                            </entry>
                            <entry>
<key>Module Directory</key>
                            </entry>
                            <entry>
<key>nifiprocessoremail</key>
<value>${nifiProcessorEmail}</value>
                            </entry>
                            <entry>
<key>nifiprocessoremailpswd</key>
<value>${nifiProcessorEmailPswd}</value>
                            </entry>
                            <entry>
<key>outputfilename</key>
<value>${sender_uuid}</value>
                            </entry>
                            <entry>
<key>password</key>
<value>${password}</value>
                            </entry>
                            <entry>
<key>sender_address</key>
<value>${sender_address}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>SendResponseEmailScript</name>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>failure</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.script.ExecuteScript</type>
                </processors>
                <processors>
                    <id>b4923e9e-3cf5-3664-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1363.4406716177148</x>
                        <y>971.474969130018</y>
                    </position>
                    <versionedComponentId>c5123755-f55a-3c61-8724-2ac92a404723</versionedComponentId>
                    <bundle>
                        <artifact>nifi-update-attribute-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Delete Attributes Expression</key>
<value>
    <name>Delete Attributes Expression</name>
</value>
                            </entry>
                            <entry>
<key>Store State</key>
<value>
    <name>Store State</name>
</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
<value>
    <name>Stateful Variables Initial Value</name>
</value>
                            </entry>
                            <entry>
<key>email.headers.from.0</key>
<value>
    <name>email.headers.from.0</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Delete Attributes Expression</key>
                            </entry>
                            <entry>
<key>Store State</key>
<value>Do not store state</value>
                            </entry>
                            <entry>
<key>Stateful Variables Initial Value</key>
                            </entry>
                            <entry>
<key>email.headers.from.0</key>
<value>${email.headers.from.0:substringAfter('&lt;'):substringBeforeLast('&gt;')}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>ExtractOnlySenderEmailAddress</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.attributes.UpdateAttribute</type>
                </processors>
                <processors>
                    <id>c17fe8c4-18a9-379b-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1675.6898001079157</x>
                        <y>109.04158535671337</y>
                    </position>
                    <versionedComponentId>000e2d83-efbe-349d-862f-6a55886f39aa</versionedComponentId>
                    <bundle>
                        <artifact>nifi-email-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>host</key>
<value>
    <name>host</name>
</value>
                            </entry>
                            <entry>
<key>port</key>
<value>
    <name>port</name>
</value>
                            </entry>
                            <entry>
<key>user</key>
<value>
    <name>user</name>
</value>
                            </entry>
                            <entry>
<key>password</key>
<value>
    <name>password</name>
</value>
                            </entry>
                            <entry>
<key>folder</key>
<value>
    <name>folder</name>
</value>
                            </entry>
                            <entry>
<key>fetch.size</key>
<value>
    <name>fetch.size</name>
</value>
                            </entry>
                            <entry>
<key>delete.messages</key>
<value>
    <name>delete.messages</name>
</value>
                            </entry>
                            <entry>
<key>connection.timeout</key>
<value>
    <name>connection.timeout</name>
</value>
                            </entry>
                            <entry>
<key>Mark Messages as Read</key>
<value>
    <name>Mark Messages as Read</name>
</value>
                            </entry>
                            <entry>
<key>Use SSL</key>
<value>
    <name>Use SSL</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>host</key>
<value>imap.gmail.com</value>
                            </entry>
                            <entry>
<key>port</key>
<value>993</value>
                            </entry>
                            <entry>
<key>user</key>
<value>${nifiProcessorEmail}</value>
                            </entry>
                            <entry>
<key>password</key>
                            </entry>
                            <entry>
<key>folder</key>
<value>INBOX</value>
                            </entry>
                            <entry>
<key>fetch.size</key>
<value>10</value>
                            </entry>
                            <entry>
<key>delete.messages</key>
<value>false</value>
                            </entry>
                            <entry>
<key>connection.timeout</key>
<value>30 sec</value>
                            </entry>
                            <entry>
<key>Mark Messages as Read</key>
<value>false</value>
                            </entry>
                            <entry>
<key>Use SSL</key>
<value>true</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>ConsumeEmail</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>success</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.email.ConsumeIMAP</type>
                </processors>
                <processors>
                    <id>ee0818b3-b03e-3f01-0000-000000000000</id>
                    <parentGroupId>4f2953fe-9999-3962-0000-000000000000</parentGroupId>
                    <position>
                        <x>-1357.6822630031288</x>
                        <y>449.2626036415602</y>
                    </position>
                    <versionedComponentId>65d68dbc-899f-339b-bf55-ab8cbaf78d0c</versionedComponentId>
                    <bundle>
                        <artifact>nifi-standard-nar</artifact>
                        <group>org.apache.nifi</group>
                        <version>1.7.1</version>
                    </bundle>
                    <config>
                        <bulletinLevel>WARN</bulletinLevel>
                        <comments></comments>
                        <concurrentlySchedulableTaskCount>1</concurrentlySchedulableTaskCount>
                        <descriptors>
                            <entry>
<key>Routing Strategy</key>
<value>
    <name>Routing Strategy</name>
</value>
                            </entry>
                            <entry>
<key>required mail</key>
<value>
    <name>required mail</name>
</value>
                            </entry>
                        </descriptors>
                        <executionNode>ALL</executionNode>
                        <lossTolerant>false</lossTolerant>
                        <penaltyDuration>30 sec</penaltyDuration>
                        <properties>
                            <entry>
<key>Routing Strategy</key>
<value>Route to 'match' if any matches</value>
                            </entry>
                            <entry>
<key>required mail</key>
<value>${anyMatchingAttribute("email.headers.subject"):contains("test"):and(${email.attachment_count:gt(0)})}</value>
                            </entry>
                        </properties>
                        <runDurationMillis>0</runDurationMillis>
                        <schedulingPeriod>0 sec</schedulingPeriod>
                        <schedulingStrategy>TIMER_DRIVEN</schedulingStrategy>
                        <yieldDuration>1 sec</yieldDuration>
                    </config>
                    <executionNodeRestricted>false</executionNodeRestricted>
                    <name>RouteOnlyApplicableEmails</name>
                    <relationships>
                        <autoTerminate>false</autoTerminate>
                        <name>matched</name>
                    </relationships>
                    <relationships>
                        <autoTerminate>true</autoTerminate>
                        <name>unmatched</name>
                    </relationships>
                    <state>RUNNING</state>
                    <style/>
                    <type>org.apache.nifi.processors.standard.RouteOnAttribute</type>
                </processors>
            </contents>
            <name>group</name>
            <variables>
                <entry>
                    <key>nifiProcessorEmailPswd</key>
                    <value>N1F1T3st</value>
                </entry>
                <entry>
                    <key>batchManagerEmail</key>
                    <value>michael@zenaptix.com</value>
                </entry>
                <entry>
                    <key>nifiProcessorEmail</key>
                    <value>zenaptixnifitest@gmail.com</value>
                </entry>
            </variables>
        </processGroups>
    </snippet>
    <timestamp>09/30/2019 08:52:40 UTC</timestamp>
</template>
